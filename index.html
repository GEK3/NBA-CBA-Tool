<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Roster & Trade Decision Tool - 2025-26 Season (With Hard Cap Tracker)</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        const capOptions = [
          { id: "RoomTeam", label: "Room Team", description: "Under the salary cap ($154.647M) with room to sign players" },
          { id: "NonTaxTeam", label: "Non-Tax Team", description: "Over cap but under the luxury tax ($187.895M)" },
          { id: "TaxTeam", label: "Tax Team", description: "Over luxury tax but under the first apron ($195.945M)" },
          { id: "FirstApronTeam", label: "First Apron Team", description: "Between the first and second aprons ($195.945M-$207.824M)" },
          { id: "SecondApronTeam", label: "Second Apron Team", description: "Over the second apron ($207.824M+) with strictest limitations" },
        ];

        const toolsByCapStatus = {
          RoomTeam: [
            { id: "CapSpace", label: "Use Cap Space", description: "Sign players using available cap room" },
            { id: "RoomMLE", label: "Room MLE ($8.781M)", description: "Mid-level exception for teams with cap space" },
            { id: "TradeRoomPlus", label: "Trade Using Room + $250k", description: "Acquire players using cap room plus additional $250k cushion" },
            { id: "VetMin", label: "Veteran Minimum", description: "Sign players to minimum contracts" },
            { id: "RookieSign", label: "Sign Draft Picks", description: "Sign first and second-round picks" },
            { id: "UseDPE", label: "Disabled Player Exception", description: "Replace injured players (lesser of 50% salary or NT-MLE)" },
          ],
          NonTaxTeam: [
            { id: "NTMLE", label: "Non-Taxpayer MLE ($14.104M)", description: "Full mid-level exception" },
            { id: "BAE", label: "Bi-Annual Exception ($5.134M)", description: "Can be used every other year" },
            { id: "SNT_Acquire", label: "Sign-and-Trade (Acquire)", description: "Receive a player via sign-and-trade" },
            { id: "TradeStandard", label: "Standard Trade Matching", description: "Match salaries within 100% plus $250,000" },
            { id: "", label: "Aggregated Trade Matching", description: "Combine 2+ contracts to match salaries (hard caps at second apron)" },
            { id: "TradeExpanded", label: "Expanded Trade Matching", description: "Take back up to 200% or 125% of outgoing salary (hard caps at first apron)" },
            { id: "TPEUse", label: "Trade Player Exception", description: "Use existing trade exceptions" },
            { id: "VetMin", label: "Veteran Minimum", description: "Sign players to minimum contracts" },
            { id: "RookieSign", label: "Sign Draft Picks", description: "Sign first and second-round picks" },
            { id: "UseDPE", label: "Disabled Player Exception", description: "Replace injured players" },
            { id: "StretchWaive", label: "Stretch & Waive", description: "Spread dead money over multiple years" },
          ],
          TaxTeam: [
            { id: "NTMLE", label: "Non-Taxpayer MLE ($14.1M)", description: "Full mid-level exception (hard caps at first apron)" },
            { id: "BAE", label: "Bi-Annual Exception ($5.1M)", description: "Can be used every other year (hard caps at first apron)" },
            { id: "TPMLE", label: "Taxpayer MLE ($5.7M)", description: "Reduced mid-level exception (no hard cap)" },
            { id: "SNT_Acquire", label: "Sign-and-Trade (Acquire)", description: "Receive a player via sign-and-trade (hard caps at first apron)" },
            { id: "TradeStandard", label: "Standard Trade Matching", description: "Match salaries within 100% plus $250,000" },
            { id: "TradeAggregated", label: "Aggregated Trade Matching", description: "Combine 2+ contracts to match salaries (hard caps at second apron)" },
            { id: "TPEUse", label: "Trade Player Exception", description: "Use existing trade exceptions" },
            { id: "VetMin", label: "Veteran Minimum", description: "Sign players to minimum contracts" },
            { id: "RookieSign", label: "Sign Draft Picks", description: "Sign first and second-round picks" },
            { id: "UseDPE", label: "Disabled Player Exception", description: "Replace injured players" },
            { id: "StretchWaive", label: "Stretch & Waive", description: "Spread dead money over multiple years" },
          ],
          FirstApronTeam: [
            { id: "TPMLE", label: "Taxpayer MLE ($5.685M)", description: "Reduced mid-level exception (hard caps at 2nd apron)" },
            { id: "TradeStandardOnly", label: "Standard Trade Matching Only", description: "100% matching (NO $250k cushion)" },
            { id: "TradeAggregated", label: "Aggregated Trade Matching", description: "Combine 2+ contracts but must match exactly (hard caps at second apron)" },
            { id: "VetMin", label: "Veteran Minimum", description: "Sign players to minimum contracts" },
            { id: "Use2Way", label: "Two-Way Contracts", description: "Sign players to two-way deals" },
            { id: "RookieSign", label: "Sign Draft Picks", description: "Sign first and second-round picks" },
            { id: "UseDPE", label: "Disabled Player Exception", description: "Replace injured players" },
            { id: "StretchWaive", label: "Stretch & Waive", description: "Spread dead money over multiple years" },
          ],
          SecondApronTeam: [
            { id: "VetMin", label: "Veteran Minimum", description: "Sign players to minimum contracts only" },
            { id: "TradeLimitedSevere", label: "Severely Limited Trades", description: "Cannot aggregate salaries, take back more money, or use cash" },
            { id: "RookieSign", label: "Sign Draft Picks", description: "Sign first and second-round picks" },
            { id: "Use2Way", label: "Two-Way Contracts", description: "Sign players to two-way deals" },
            { id: "StretchWaive", label: "Stretch & Waive", description: "Spread dead money over multiple years" },
          ],
        };

        const toolImplications = {
          CapSpace: {
            pros: [
              "Maximum flexibility to sign free agents",
              "Can offer contracts up to the max salary",
              "Can front-load or back-load contracts",
              "No hard cap restrictions"
            ],
            cons: [
              "Must renounce cap holds on existing free agents",
              "Lose Bird Rights on renounced players",
              "Cannot exceed the cap once space is used"
            ],
            restrictions: []
          },
          RoomMLE: {
            pros: [
              "Additional $8.781M to use after cap space",
              "3-year contracts allowed",
              "Can be split among multiple players"
            ],
            cons: [
              "Cannot use Non-Taxpayer MLE",
              "Cannot use Bi-Annual Exception",
              "Limited to teams under the cap"
            ],
            restrictions: []
          },
          TradeRoomPlus: {
            pros: [
              "Can absorb contracts using cap space",
              "Additional $250k cushion beyond available room",
              "No need to match salaries",
              "Can take on bad contracts for assets",
              "Most flexible trade option for teams under cap"
            ],
            cons: [
              "Limited to available cap space plus $250k",
              "Cannot simultaneously use other traded player exceptions",
              "Reduces available cap space for free agents",
              "$250k cushion reduced to $0 if trade puts team over First Apron"
            ],
            restrictions: []
          },
          NTMLE: {
            pros: [
              "Up to $14.104M available",
              "Can offer up to 4-year contracts", 
              "Can be split among multiple players",
              "5% annual raises allowed",
              "No hard cap if used for less than $5.685M on 1-2 year deals"
            ],
            cons: [
              "Triggers hard cap at first apron if used for 3+ years OR $5.685M+ total",
              "Cannot exceed apron for ANY reason once triggered",
              "Must stay under apron all season",
              "Cannot be used by teams already over first apron"
            ],
            restrictions: ["Hard cap at $195.945M if: Contract is 3+ years OR total MLE usage exceeds $5.685M (taxpayer MLE limit)"]
          },
          BAE: {
            pros: [
              "Additional $5.134M exception",
              "2-year contracts allowed",
              "Can be used with other exceptions"
            ],
            cons: [
              "Triggers hard cap at first apron",
              "Only available every other year",
              "Cannot be combined with sign-and-trades"
            ],
            restrictions: ["Hard cap at $195.945M (first apron)", "Available every other year"]
          },
          SNT_Acquire: {
            pros: [
              "Can acquire players you couldn't sign outright",
              "Maintains Bird Rights on the acquired player",
              "Can be part of larger trades",
              "Allows teams over cap to add talent"
            ],
            cons: [
              "Triggers hard cap at first apron",
              "3-year minimum contract length for S&T player",
              "Must send out assets/players in return",
              "Player salary may be limited based on prior contract"
            ],
            restrictions: ["Hard cap at $195.945M (first apron)", "Cannot re-trade player for 3 months", "Special salary rules apply"]
          },
          TradeStandard: {
            pros: [
              "Match within 100% of outgoing salary plus $250,000",
              "Can be used multiple times",
              "Creates trade exception from salary differential", 
              "No hard cap implications",
              "Can acquire players non-simultaneously within 1 year"
            ],
            cons: [
              "Must send out nearly equal salary",
              "Cannot combine with other matching rules",
              "Limited flexibility compared to room trades",
              "$250,000 cushion reduced to $0 if trade puts team over First Apron"
            ],
            restrictions: []
          },
          TradeAggregated: {
            pros: [
              "Can combine 2+ outgoing contracts to match salaries",
              "Match within 100% of aggregated salaries plus $250,000",
              "Greater flexibility in trade construction",
              "Useful for acquiring higher-salaried players"
            ],
            cons: [
"Hard caps team at second apron - must stay under $207.824M post-trade",
              "Cannot aggregate players acquired via exception in prior 2 months",
              "Complex rules on minimum salary players",
              "Must be simultaneous trades",
              "$250,000 cushion reduced to $0 if trade puts team over First Apron"
            ],
            restrictions: ["Triggers hard cap at $207.824M (second apron)", "2-month waiting period for aggregating traded players"]
          },
          TradeExpanded: {
            pros: [
              "Maximum flexibility for trades",
              "Can take back the greater of:",
              "â€¢ Lesser of: 200% of outgoing OR 100% + $8.5M (2025-26)",
              "â€¢ Or: 125% of outgoing + $250,000",
              "Best option for acquiring higher-salaried players"
            ],
            cons: [
              "Triggers hard cap at first apron",
              "Cannot be used by teams already over first apron",
              "Must be simultaneous trade",
              "$250,000 cushion reduced to $0 if trade puts team over First Apron"
            ],
            restrictions: ["Hard cap at $195.945M (first apron)", "Cannot use if already over first apron"]
          },
          TPEUse: {
            pros: [
              "Can acquire players without sending salary back", 
              "Created from previous trades where you sent out more salary",
              "Can be used within one year of creation",
              "No immediate salary matching required",
              "Can split TPE to acquire multiple players"
            ],
            cons: [
              "Limited to size of exception created",
              "Expires after one year",
              "Cannot combine TPEs together",
              "Cannot combine TPE with player salaries",
              "Pre-existing TPEs frozen if team is over first apron"
            ],
            restrictions: ["Cannot use pre-existing TPEs if over first apron", "Cannot use if over second apron"]
          },
          TPMLE: {
            pros: [
              "Up to $5.685M available",
              "Can offer 2-year contracts",
              "Available to teams over luxury tax but under second apron"
            ],
            cons: [
              "Much smaller than Non-Taxpayer MLE",
              "Limited player pool at this salary",
              "Not available to teams over second apron",
              "Triggers hard cap at second apron"
            ],
            restrictions: ["Triggers hard cap at $207.824M (second apron)", "Cannot be used if over second apron"]
          },
          TradeStandardOnly: {
            pros: [
              "Can still make trades despite apron status",
              "100% matching (dollar for dollar)"
            ],
            cons: [
              "Cannot aggregate salaries",
              "NO $250k cushion (reduced to $0 for apron teams)",
              "Must match exactly dollar-for-dollar",
              "Very limited trade flexibility",
              "Difficult to improve roster via trade"
            ],
            restrictions: ["No salary aggregation allowed", "No $250k cushion"]
          },
          VetMin: {
            pros: [
              "Always available regardless of cap situation",
              "League subsidizes portion for vets with 3+ years",
              "No cap implications",
              "Can sign throughout the season"
            ],
            cons: [
              "Limited to minimum salary scale",
              "Harder to attract quality players",
              "1-2 year contracts only"
            ],
            restrictions: []
          },
          TradeLimitedSevere: {
            pros: [
              "Can still make trades if absolutely needed",
              "Can match salaries exactly (100%, no cushion)"
            ],
            cons: [
              "Cannot aggregate salaries",
              "Cannot take back more salary than sent out",
              "Cannot use cash in trades",
              "Cannot use any pre-existing TPEs",
              "Cannot trade first-round picks 7+ years out",
              "Frozen draft pick selection"
            ],
            restrictions: ["No aggregation", "No cash", "Cannot take back more salary", "No TPE usage", "Pick restrictions"]
          },
          Use2Way: {
            pros: [
              "Doesn't count against salary cap",
              "Can develop young talent",
              "Flexible roster management",
              "Can have up to 3 two-way players"
            ],
            cons: [
              "Limited to 50 NBA games",
              "Lower salary for players",
              "Must have roster spot to convert",
              "Players must have 3 or fewer years of service"
            ],
            restrictions: ["50 game limit", "Maximum 3 two-way players", "3 or fewer years of service"]
          },
          RookieSign: {
            pros: [
              "Cost-controlled contracts",
              "Rookie scale predetermined",
              "Team options for years 3 and 4",
              "Can extend before free agency"
            ],
            cons: [
              "Must use cap space or exception",
              "Limited to draft position scale",
              "Must sign within deadlines"
            ],
            restrictions: []
          },
          UseDPE: {
            pros: [
              "Replace injured player mid-season",
              "Lesser of 50% of injured player's salary or Non-Tax MLE ($14.104M)",
              "Can be crucial for playoff runs",
              "Additional roster flexibility"
            ],
            cons: [
              "Requires significant injury (player out through June 15)",
              "Complex qualification process",
              "Limited time to use (July 1 - January 15)",
              "Cannot be used if injury occurred with another team"
            ],
            restrictions: ["Requires NBA approval", "Cannot apply if injury occurred with another team"]
          },
          StretchWaive: {
            pros: [
              "Creates immediate cap relief",
              "Spreads dead money over multiple years",
              "Can help get under tax or apron"
            ],
            cons: [
              "Dead money counts against cap for years",
              "Still paying player not on roster",
              "Reduces future flexibility"
            ],
            restrictions: ["Formula: Total Salary / (Years remaining Ã— 2) + 1"]
          }
        };

        // Team salary data for 2025-26 season (updated with actual exception usage from Excel file)
        const teamData = {
          ATL: { capSalary: 197.607, apronSalary: 182.384, taxSalary: 182.384, taxBill: 0, hardCap: "first", reason: "Signed Luke Kennard using NT-MLE", exceptionsUsed: ["NTMLE"] },
          BKN: { capSalary: 134.734, apronSalary: 115.208, taxSalary: 114.424, taxBill: 0, hardCap: null, exceptionsUsed: [], capSpace: 19.91301 },
          BOS: { capSalary: 237.439, apronSalary: 208.156, taxSalary: 208.156, taxBill: 88.439, hardCap: null, exceptionsUsed: [] },
          CHA: { capSalary: 192.372, apronSalary: 176.099, taxSalary: 171.007, taxBill: 0, hardCap: "first", reason: "Hard cap triggered", exceptionsUsed: [] },
          CHI: { capSalary: 183.022, apronSalary: 152.259, taxSalary: 149.276, taxBill: 0, hardCap: "first", reason: "Hard cap triggered", exceptionsUsed: [] },
          CLE: { capSalary: 243.137, apronSalary: 227.538, taxSalary: 225.015, taxBill: 141.040, hardCap: null, exceptionsUsed: [] },
          DAL: { capSalary: 228.701, apronSalary: 206.240, taxSalary: 204.457, taxBill: 30.963, hardCap: "second", reason: "Signed D'Angelo Russell using TP-MLE", exceptionsUsed: ["TPMLE"] },
          DEN: { capSalary: 213.894, apronSalary: 198.519, taxSalary: 193.723, taxBill: 17.521, hardCap: "second", reason: "Aggregated salaries in trade", exceptionsUsed: ["aggregation"] },
          DET: { capSalary: 174.719, apronSalary: 165.440, taxSalary: 163.168, taxBill: 0, hardCap: "first", reason: "Signed Caris LeVert using NT-MLE", exceptionsUsed: ["NTMLE"] },
          GSW: { capSalary: 250.530, apronSalary: 170.932, taxSalary: 170.506, taxBill: 0, hardCap: null, exceptionsUsed: [] },
          HOU: { capSalary: 201.082, apronSalary: 192.393, taxSalary: 192.393, taxBill: 4.498, hardCap: "first", reason: "Signed Dorian Finney-Smith using NT-MLE", exceptionsUsed: ["NTMLE"] },
          IND: { capSalary: 189.250, apronSalary: 182.353, taxSalary: 180.561, taxBill: 0, hardCap: "first", reason: "Hard cap triggered", exceptionsUsed: [] },
          LAC: { capSalary: 205.485, apronSalary: 187.016, taxSalary: 192.371, taxBill: 13.427, hardCap: "first", reason: "Signed Bradley Beal and Brook Lopez using NT-MLE", exceptionsUsed: ["NTMLE"] },
          LAL: { capSalary: 214.182, apronSalary: 195.036, taxSalary: 193.764, taxBill: 17.651, hardCap: "first", reason: "Signed Jake LaRavia and Deandre Ayton using NT-MLE", exceptionsUsed: ["NTMLE"] },
          MEM: { capSalary: 180.196, apronSalary: 172.007, taxSalary: 171.507, taxBill: 0, hardCap: null, exceptionsUsed: ["RoomMLE"] },
          MIA: { capSalary: 202.819, apronSalary: 191.789, taxSalary: 189.289, taxBill: 1.394, hardCap: "first", reason: "Hard cap triggered", exceptionsUsed: [] },
          MIL: { capSalary: 171.786, apronSalary: 174.186, taxSalary: 171.786, taxBill: 0, hardCap: null, exceptionsUsed: ["RoomMLE"] },
          MIN: { capSalary: 241.476, apronSalary: 201.965, taxSalary: 200.285, taxBill: 16.360, hardCap: null, exceptionsUsed: [] },
          NOP: { capSalary: 206.456, apronSalary: 190.004, taxSalary: 182.379, taxBill: 0, hardCap: "first", reason: "Signed Kevon Looney using NT-MLE", exceptionsUsed: ["NTMLE"] },
          NYK: { capSalary: 233.580, apronSalary: 204.106, taxSalary: 204.106, taxBill: 29.736, hardCap: "second", reason: "Acquired players via sign-and-trade", exceptionsUsed: ["TPMLE"] },
          OKC: { capSalary: 193.029, apronSalary: 187.378, taxSalary: 186.878, taxBill: 0, hardCap: null, exceptionsUsed: [] },
          ORL: { capSalary: 198.874, apronSalary: 194.704, taxSalary: 192.198, taxBill: 4.303, hardCap: "first", reason: "Signed Tyus Jones using NT-MLE", exceptionsUsed: ["NTMLE"] },
          PHI: { capSalary: 206.372, apronSalary: 186.065, taxSalary: 186.841, taxBill: 0, hardCap: null, exceptionsUsed: [] },
          PHX: { capSalary: 213.083, apronSalary: 187.071, taxSalary: 184.546, taxBill: 0, hardCap: null, exceptionsUsed: [] },
          POR: { capSalary: 187.068, apronSalary: 171.636, taxSalary: 184.079, taxBill: 0, hardCap: "first", reason: "Signed Damian Lillard using NT-MLE", exceptionsUsed: ["NTMLE"] },
          SAC: { capSalary: 211.726, apronSalary: 186.062, taxSalary: 181.190, taxBill: 0, hardCap: "first", reason: "Hard cap triggered", exceptionsUsed: [] },
          SAS: { capSalary: 206.152, apronSalary: 181.342, taxSalary: 177.642, taxBill: 0, hardCap: "first", reason: "Signed Luke Kornet using NT-MLE", exceptionsUsed: ["NTMLE"] },
          TOR: { capSalary: 221.429, apronSalary: 199.260, taxSalary: 192.894, taxBill: 4.999, hardCap: null, exceptionsUsed: [] },
          UTA: { capSalary: 150.358, apronSalary: 146.260, taxSalary: 146.260, taxBill: 0, hardCap: "first", reason: "Hard cap triggered", exceptionsUsed: [] },
          WAS: { capSalary: 241.051, apronSalary: 165.193, taxSalary: 161.721, taxBill: 0, hardCap: "first", reason: "Hard cap triggered", exceptionsUsed: [] }
        };

        // Team colors for visual representation
        const teamColors = {
          ATL: "#E03A3E",
          BKN: "#000000",
          BOS: "#007A33",
          CHA: "#1D1160",
          CHI: "#CE1141",
          CLE: "#6F263D",
          DAL: "#00538C",
          DEN: "#FEC524",
          DET: "#C8102E",
          GSW: "#1D428A",
          HOU: "#CE1141",
          IND: "#002D62",
          LAC: "#C8102E",
          LAL: "#552583",
          MEM: "#5D76A9",
          MIA: "#98002E",
          MIL: "#00471B",
          MIN: "#0C2340",
          NOP: "#0C2340",
          NYK: "#006BB6",
          OKC: "#007AC1",
          ORL: "#0077C0",
          PHI: "#006BB6",
          PHX: "#1D1160",
          POR: "#E03A3E",
          SAC: "#5A2D81",
          SAS: "#C4CED4",
          TOR: "#CE1141",
          UTA: "#002B5C",
          WAS: "#002B5C"
        };

        // League Salary Overview Chart Component
        const LeagueSalaryChart = () => {
          const [salaryView, setSalaryView] = useState("apronSalary");
          
          // Get the selected salary value for each team
          const getTeamSalary = (team) => {
            if (salaryView === "capSalary") return team.capSalary;
            if (salaryView === "taxSalary") return team.taxSalary;
            return team.apronSalary; // Default to apron salary
          };
          
          // Sort teams by selected salary type
          const sortedTeams = Object.entries(teamData)
            .sort((a, b) => getTeamSalary(a[1]) - getTeamSalary(b[1]))
            .map(([team, data]) => ({ team, ...data }));

          // Chart dimensions
          const chartWidth = 800;
          const chartHeight = 930;
          const margin = { top: 20, right: 160, bottom: 60, left: 50 };
          const barHeight = 20;
          const barSpacing = 8;

          // Salary thresholds
          const salaryFloor = 134.352;
          const salaryCap = 154.647;
          const luxuryTax = 187.895;
          const firstApron = 195.945;
          const secondApron = 207.824;
          
          // Adjust max salary based on view
          const maxSalary = salaryView === "capSalary" ? 260 : 230;
          const minSalary = salaryView === "capSalary" ? 130 : 110;

          // Scale for x-axis
          const scaleX = (value) => {
            return margin.left + ((value - minSalary) / (maxSalary - minSalary)) * (chartWidth - margin.left - margin.right);
          };

          // Get bar color based on salary amount
          const getBarColor = (salary) => {
            if (salary >= secondApron) return "#EF4444"; // Red
            if (salary >= firstApron) return "#F59E0B"; // Orange
            if (salary >= luxuryTax) return "#FCD34D"; // Yellow
            if (salary >= salaryCap) return "#3B82F6"; // Blue
            return "#10B981"; // Green
          };

          // Get descriptive text for each view
          const getViewDescription = () => {
            switch(salaryView) {
              case "apronSalary":
                return "Showing apron salary (excludes cap holds - used for apron status)";
              case "capSalary":
                return "Showing total cap allocations (includes cap holds, exceptions, etc.)";
              case "taxSalary":
                return "Showing tax calculation salary (amount used for luxury tax calculations)";
              default:
                return "";
            }
          };

          return (
            <div className="bg-gray-800 rounded-lg p-6 overflow-x-auto">
              <div className="flex justify-between items-start mb-4">
                <div>
                  <h3 className="text-xl font-semibold">League Salary Overview (2025-26)</h3>
                  <p className="text-xs text-gray-400 mt-1">
                    {getViewDescription()}
                  </p>
                </div>
                <div className="flex flex-col items-end">
                  <label className="text-xs text-gray-400 mb-1">Select Salary View:</label>
                  <select
                    value={salaryView}
                    onChange={(e) => setSalaryView(e.target.value)}
                    className="px-3 py-1 bg-gray-700 border border-gray-600 rounded text-sm text-white focus:outline-none focus:border-blue-500"
                  >
                    <option value="apronSalary">Apron Salary (for status)</option>
                    <option value="capSalary">Cap Allocations (total)</option>
                    <option value="taxSalary">Tax Salary (for tax bill)</option>
                  </select>
                </div>
              </div>
              
              <svg width={chartWidth} height={chartHeight} className="mx-auto">
                {/* Threshold lines */}
                <line x1={scaleX(salaryFloor)} y1={margin.top + 50} x2={scaleX(salaryFloor)} y2={chartHeight - margin.bottom} 
                      stroke="#4B5563" strokeWidth="2" strokeDasharray="5,5" />
                <line x1={scaleX(salaryCap)} y1={margin.top + 50} x2={scaleX(salaryCap)} y2={chartHeight - margin.bottom} 
                      stroke="#10B981" strokeWidth="2" />
                <line x1={scaleX(luxuryTax)} y1={margin.top + 50} x2={scaleX(luxuryTax)} y2={chartHeight - margin.bottom} 
                      stroke="#3B82F6" strokeWidth="2" />
                <line x1={scaleX(firstApron)} y1={margin.top + 50} x2={scaleX(firstApron)} y2={chartHeight - margin.bottom} 
                      stroke="#F59E0B" strokeWidth="2" />
                <line x1={scaleX(secondApron)} y1={margin.top + 50} x2={scaleX(secondApron)} y2={chartHeight - margin.bottom} 
                      stroke="#EF4444" strokeWidth="2" />

                {/* Team bars */}
                {sortedTeams.map((teamData, index) => {
                  const y = margin.top + index * (barHeight + barSpacing) + 50;
                  const salary = getTeamSalary(teamData);
                  const barWidth = scaleX(salary) - margin.left;
                  const barColor = getBarColor(salary);

                  return (
                    <g key={teamData.team}>
                      {/* Team bar */}
                      <rect
                        x={margin.left}
                        y={y}
                        width={barWidth}
                        height={barHeight}
                        fill={barColor}
                        opacity="0.8"
                      />
                      
                      {/* Team label box */}
                      <rect
                        x={margin.left - 45}
                        y={y}
                        width={40}
                        height={barHeight}
                        fill={teamColors[teamData.team]}
                        rx="3"
                      />
                      <text
                        x={margin.left - 25}
                        y={y + barHeight / 2 + 4}
                        textAnchor="middle"
                        fill="white"
                        fontSize="11"
                        fontWeight="bold"
                      >
                        {teamData.team}
                      </text>
                      
                      {/* Salary amount */}
                      <text
                        x={scaleX(salary) + 5}
                        y={y + barHeight / 2 + 4}
                        fill="white"
                        fontSize="10"
                      >
                        ${salary.toFixed(1)}M
                      </text>
                      
                      {/* Hard cap indicator */}
                      {teamData.hardCap && (
                        <text
                          x={scaleX(salary) + 55}
                          y={y + barHeight / 2 + 4}
                          fill={teamData.hardCap === "first" ? "#F59E0B" : "#EF4444"}
                          fontSize="10"
                          fontWeight="bold"
                        >
                          ðŸ”’{teamData.hardCap === "first" ? "1st" : "2nd"}
                        </text>
                      )}
                      
                      {/* Cap space indicator - only show for apron salary view */}
                      {salaryView === "apronSalary" && teamData.capSpace && (
                        <text
                          x={scaleX(salary) + 90}
                          y={y + barHeight / 2 + 4}
                          fill="#10B981"
                          fontSize="10"
                        >
                          ðŸ’°${teamData.capSpace.toFixed(1)}M
                        </text>
                      )}
                      
                      {/* Show difference between selected view and apron salary */}
                      {salaryView !== "apronSalary" && (
                        <text
                          x={scaleX(salary) + 90}
                          y={y + barHeight / 2 + 4}
                          fill="#9CA3AF"
                          fontSize="9"
                        >
                          (Î” ${(salary - teamData.apronSalary).toFixed(1)}M)
                        </text>
                      )}
                      
                      {/* Tax bill indicator for tax salary view */}
                      {salaryView === "taxSalary" && teamData.taxBill > 0 && (
                        <text
                          x={scaleX(salary) + 140}
                          y={y + barHeight / 2 + 4}
                          fill="#FCD34D"
                          fontSize="9"
                        >
                          ðŸ’¸${teamData.taxBill.toFixed(1)}M
                        </text>
                      )}
                    </g>
                  );
                })}

                {/* X-axis labels */}
                <text x={scaleX(salaryFloor)} y={chartHeight - margin.bottom + 20} textAnchor="middle" fill="#9CA3AF" fontSize="11">
                  Floor
                </text>
                <text x={scaleX(salaryFloor)} y={chartHeight - margin.bottom + 35} textAnchor="middle" fill="#9CA3AF" fontSize="10">
                  $134.4M
                </text>
                
                <text x={scaleX(salaryCap)} y={chartHeight - margin.bottom + 20} textAnchor="middle" fill="#10B981" fontSize="11">
                  Cap
                </text>
                <text x={scaleX(salaryCap)} y={chartHeight - margin.bottom + 35} textAnchor="middle" fill="#10B981" fontSize="10">
                  $154.6M
                </text>
                
                <text x={scaleX(luxuryTax)} y={chartHeight - margin.bottom + 20} textAnchor="middle" fill="#3B82F6" fontSize="11">
                  Tax
                </text>
                <text x={scaleX(luxuryTax)} y={chartHeight - margin.bottom + 35} textAnchor="middle" fill="#3B82F6" fontSize="10">
                  $187.9M
                </text>
                
                <text x={scaleX(firstApron)} y={chartHeight - margin.bottom + 20} textAnchor="middle" fill="#F59E0B" fontSize="11">
                  1st Apron
                </text>
                <text x={scaleX(firstApron)} y={chartHeight - margin.bottom + 35} textAnchor="middle" fill="#F59E0B" fontSize="10">
                  $195.9M
                </text>
                
                <text x={scaleX(secondApron)} y={chartHeight - margin.bottom + 20} textAnchor="middle" fill="#EF4444" fontSize="11">
                  2nd Apron
                </text>
                <text x={scaleX(secondApron)} y={chartHeight - margin.bottom + 35} textAnchor="middle" fill="#EF4444" fontSize="10">
                  $207.8M
                </text>

                {/* Title */}
                <text x={chartWidth / 2} y={15} textAnchor="middle" fill="white" fontSize="14" fontWeight="bold">
                  Team {salaryView === "capSalary" ? "Cap Allocations" : salaryView === "taxSalary" ? "Tax Salaries" : "Apron Salaries"} vs. Key Thresholds
                </text>
              </svg>

              <div className="mt-4 flex flex-wrap gap-4 text-xs justify-center">
                <div className="flex items-center gap-2">
                  <div className="w-4 h-4 bg-green-500 rounded"></div>
                  <span className="text-gray-400">Under Cap</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-4 h-4 bg-blue-500 rounded"></div>
                  <span className="text-gray-400">Under Tax</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-4 h-4 bg-yellow-300 rounded"></div>
                  <span className="text-gray-400">Over Tax</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-4 h-4 bg-amber-500 rounded"></div>
                  <span className="text-gray-400">Over 1st Apron</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-4 h-4 bg-red-500 rounded"></div>
                  <span className="text-gray-400">Over 2nd Apron</span>
                </div>
              </div>
              
              {salaryView === "capSalary" && (
                <div className="mt-4 p-3 bg-gray-700 rounded text-xs">
                  <p className="text-gray-400">
                    <span className="font-semibold text-yellow-400">Note:</span> Cap Allocations include cap holds, exception holds, and incomplete roster charges. 
                    The (Î”) shows the difference between cap allocations and apron salary for each team.
                  </p>
                </div>
              )}
              
              {salaryView === "taxSalary" && (
                <div className="mt-4 p-3 bg-gray-700 rounded text-xs">
                  <p className="text-gray-400">
                    <span className="font-semibold text-yellow-400">Note:</span> Tax Salary is used to calculate luxury tax bills. 
                    The (Î”) shows the difference from apron salary. The ðŸ’¸ amount shows the actual luxury tax bill owed by each team.
                  </p>
                </div>
              )}
            </div>
          );
        };

        const NBACapDecisionTool = () => {
          const [selectedTeam, setSelectedTeam] = useState("");
          const [selectedCap, setSelectedCap] = useState("");
          const [selectedTool, setSelectedTool] = useState("");
          const [teamSalary, setTeamSalary] = useState("");

          const availableTools = selectedCap ? toolsByCapStatus[selectedCap] : [];
          const implications = selectedTool ? (toolImplications[selectedTool] || {
            pros: ["Details not available"],
            cons: ["Details not available"],
            restrictions: []
          }) : null;

          const handleTeamChange = (e) => {
            const team = e.target.value;
            setSelectedTeam(team);
            
            if (team && teamData[team]) {
              const apronSalary = teamData[team].apronSalary;
              setTeamSalary(apronSalary.toString());
              
              // Auto-determine cap status based on apron salary
              let capStatus = "";
              if (apronSalary < 154.647) {
                capStatus = "RoomTeam";
              } else if (apronSalary < 187.895) {
                capStatus = "NonTaxTeam";
              } else if (apronSalary < 195.945) {
                capStatus = "TaxTeam";
              } else if (apronSalary < 207.824) {
                capStatus = "FirstApronTeam";
              } else {
                capStatus = "SecondApronTeam";
              }
              
              setSelectedCap(capStatus);
              setSelectedTool(""); // Reset tool selection
            }
          };

          const handleCapChange = (e) => {
            setSelectedCap(e.target.value);
            setSelectedTool(""); // Reset tool selection when cap status changes
          };

          const handleToolChange = (e) => {
            setSelectedTool(e.target.value);
          };

          const handleSalaryChange = (e) => {
            const value = e.target.value.replace(/[^0-9.]/g, '');
            setTeamSalary(value);
            setSelectedTeam(""); // Clear team selection if manually editing
          };

          const getCapStatusColor = (capId) => {
            switch(capId) {
              case "RoomTeam": return "text-green-400";
              case "NonTaxTeam": return "text-blue-400";
              case "TaxTeam": return "text-yellow-400";
              case "FirstApronTeam": return "text-orange-400";
              case "SecondApronTeam": return "text-red-400";
              default: return "text-gray-400";
            }
          };

          const getTeamCapStatus = (salary) => {
            const sal = parseFloat(salary);
            if (sal < 154.647) return "Under Cap";
            if (sal < 187.895) return "Under Tax";
            if (sal < 195.945) return "Over Tax";
            if (sal < 207.824) return "Over 1st Apron";
            return "Over 2nd Apron";
          };

          const formatSalary = (value) => {
            if (!value) return "";
            const num = parseFloat(value);
            return isNaN(num) ? "" : `${num.toFixed(1)}M`;
          };

          // Calculate league overview
          const leagueOverview = Object.values(teamData).reduce((acc, team) => {
            if (team.apronSalary < 154.647) acc.underCap++;
            else if (team.apronSalary < 187.895) acc.nonTax++;
            else if (team.apronSalary < 195.945) acc.overTax++;
            else if (team.apronSalary < 207.824) acc.over1st++;
            else acc.over2nd++;
            
            if (team.hardCap === "first") acc.hardCap1st++;
            else if (team.hardCap === "second") acc.hardCap2nd++;
            
            if (team.taxBill > 0) acc.payingTax++;
            
            return acc;
          }, { underCap: 0, nonTax: 0, overTax: 0, over1st: 0, over2nd: 0, hardCap1st: 0, hardCap2nd: 0, payingTax: 0 });

          return (
            <div className="min-h-screen bg-gray-900 text-white p-6">
              <div className="max-w-4xl mx-auto">
                <div className="mb-8">
                  <h1 className="text-4xl font-bold mb-2">NBA Roster & Trade Decision Tool</h1>
                  <p className="text-gray-400">Select your team to see available roster-building tools and trade options based on 2023 CBA rules</p>
                  <p className="text-xs text-gray-500 mt-2">2025-26 Season â€¢ Trade rules from CBA Article VII Section 6(j) â€¢ Team status based on apron salary (excludes cap holds)</p>
                  
                  {/* League Overview */}
                  <div className="mt-4 p-3 bg-gray-800 rounded-lg">
                    <p className="text-xs text-gray-400">
                      <span className="font-semibold">League Overview (30 teams):</span> 
                      <span className="ml-2">ðŸŸ¢ {leagueOverview.underCap} under cap</span>
                      <span className="ml-2">ðŸ”µ {leagueOverview.nonTax} non-tax</span>
                      <span className="ml-2">ðŸŸ¡ {leagueOverview.overTax} over tax</span>
                      <span className="ml-2">ðŸŸ  {leagueOverview.over1st} over 1st</span>
                      <span className="ml-2">ðŸ”´ {leagueOverview.over2nd} over 2nd</span>
                    </p>
                    <p className="text-xs text-gray-400 mt-1">
                      <span className="font-semibold">Hard Caps:</span>
                      <span className="ml-2">ðŸ”’ 16 teams at 1st apron</span>
                      <span className="ml-2">ðŸ”’ 3 teams at 2nd apron</span>
                      <span className="ml-2">ðŸ’¸ {leagueOverview.payingTax} teams paying luxury tax</span>
                    </p>
                  </div>
                </div>

                {/* League Salary Chart */}
                <LeagueSalaryChart />

                {/* Cap Allocations vs Apron Salary vs Tax Salary Explanation */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">Understanding Different Salary Calculations</h3>
                  <div className="p-4 bg-gray-700 rounded-lg mb-4">
                    <h4 className="font-semibold text-yellow-400 mb-2">Why Three Different Numbers?</h4>
                    <p className="text-sm text-gray-300 mb-3">
                      The NBA uses different calculations for various cap management purposes:
                    </p>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div className="p-3 bg-gray-600 rounded">
                        <p className="text-green-400 font-semibold text-sm mb-1">Cap Allocations</p>
                        <p className="text-xs text-gray-400 mb-2">For determining cap space</p>
                        <ul className="text-xs text-gray-300 space-y-1">
                          <li>âœ“ Active player salaries</li>
                          <li>âœ“ Dead money</li>
                          <li>âœ“ Free agent cap holds</li>
                          <li>âœ“ First-round pick holds</li>
                          <li>âœ“ Exception holds</li>
                          <li>âœ“ Incomplete roster charges</li>
                        </ul>
                      </div>
                      <div className="p-3 bg-gray-600 rounded">
                        <p className="text-blue-400 font-semibold text-sm mb-1">Apron Salary</p>
                        <p className="text-xs text-gray-400 mb-2">For apron status & restrictions</p>
                        <ul className="text-xs text-gray-300 space-y-1">
                          <li>âœ“ Active player salaries</li>
                          <li>âœ“ Dead money</li>
                          <li>âœ— Free agent cap holds</li>
                          <li>âœ— First-round pick holds</li>
                          <li>âœ— Exception holds</li>
                          <li>âœ— Incomplete roster charges</li>
                        </ul>
                      </div>
                      <div className="p-3 bg-gray-600 rounded">
                        <p className="text-yellow-400 font-semibold text-sm mb-1">Tax Salary</p>
                        <p className="text-xs text-gray-400 mb-2">For luxury tax calculations</p>
                        <ul className="text-xs text-gray-300 space-y-1">
                          <li>âœ“ Active player salaries</li>
                          <li>âœ“ Dead money</li>
                          <li>âœ“ Likely incentives</li>
                          <li>âœ— Unlikely incentives</li>
                          <li>âœ— Cap holds</li>
                          <li>â€¢ May differ from apron due to timing/incentives</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <div className="p-3 bg-yellow-900/30 border border-yellow-700 rounded-lg">
                    <p className="text-yellow-400 text-sm font-semibold">ðŸ’¡ Key Insight:</p>
                    <p className="text-yellow-300 text-xs mt-1">
                      This is why a team like Washington can have an apron salary of $165.2M (under the first apron) 
                      but cap allocations of $241.1M (well over the cap). They have $75.9M in cap holds!
                      Tax salary is typically close to apron salary but may vary based on incentives and timing.
                    </p>
                  </div>
                </div>

                {/* Cap Status Selection */}
                <div className="bg-gray-800 rounded-lg p-6 mb-6">
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                      <label className="block text-sm font-medium mb-2">Select Team</label>
                      <select
                        value={selectedTeam}
                        onChange={handleTeamChange}
                        className="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:border-blue-500 text-white mb-3"
                      >
                        <option value="">Select a team...</option>
                        {Object.keys(teamData).sort().map(team => {
                          const apronSalary = teamData[team].apronSalary;
                          let statusEmoji = "";
                          if (apronSalary < 154.647) statusEmoji = "ðŸŸ¢"; // Under cap
                          else if (apronSalary < 187.895) statusEmoji = "ðŸ”µ"; // Non-tax
                          else if (apronSalary < 195.945) statusEmoji = "ðŸŸ¡"; // Over tax
                          else if (apronSalary < 207.824) statusEmoji = "ðŸŸ "; // Over 1st apron
                          else statusEmoji = "ðŸ”´"; // Over 2nd apron
                          
                          return (
                            <option key={team} value={team}>
                              {statusEmoji} {team} - ${apronSalary.toFixed(1)}M
                              {teamData[team].capSpace && ` (${teamData[team].capSpace.toFixed(1)}M cap space)`}
                              {teamData[team].hardCap === "first" && " (HC: 1st)"}
                              {teamData[team].hardCap === "second" && " (HC: 2nd)"}
                            </option>
                          );
                        })}
                      </select>
                      
                      <div className="mt-2 text-xs text-gray-500">
                        <span className="mr-3">ðŸŸ¢ Under Cap</span>
                        <span className="mr-3">ðŸ”µ Non-Tax</span>
                        <span className="mr-3">ðŸŸ¡ Over Tax</span>
                        <span className="mr-3">ðŸŸ  Over 1st</span>
                        <span className="mr-3">ðŸ”´ Over 2nd</span>
                      </div>
                      <div className="mt-1 text-xs text-gray-500">
                        <span className="mr-3">ðŸ”’1st = Hard-capped at 1st apron ($195.9M)</span>
                        <span className="mr-3">ðŸ”’2nd = Hard-capped at 2nd apron ($207.8M)</span>
                      </div>
                      
                      <label className="block text-sm font-medium mb-2 mt-4">Or Enter Apron Salary Manually (millions)</label>
                      <input
                        type="text"
                        value={teamSalary}
                        onChange={handleSalaryChange}
                        placeholder="e.g., 175.5"
                        className="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:border-blue-500 text-white"
                      />
                      {teamSalary && !selectedTeam && (
                        <>
                          <p className="mt-2 text-sm">
                            <span className="text-gray-400">Status: </span>
                            <span className={
                              parseFloat(teamSalary) < 154.647 ? "text-green-400" :
                              parseFloat(teamSalary) < 187.895 ? "text-blue-400" :
                              parseFloat(teamSalary) < 195.945 ? "text-yellow-400" :
                              parseFloat(teamSalary) < 207.824 ? "text-orange-400" :
                              "text-red-400"
                            }>
                              {getTeamCapStatus(teamSalary)} ({formatSalary(teamSalary)})
                            </span>
                          </p>
                          <p className="text-xs text-gray-500 mt-1">
                            * Manual entry uses apron salary (excludes cap holds)
                          </p>
                        </>
                      )}
                      
                      {/* Cap Space Display */}
                      {selectedTeam && teamData[selectedTeam]?.capSpace && (
                        <div className="mt-3 p-3 bg-green-900/30 border border-green-700 rounded-lg">
                          <p className="text-green-400 text-xs font-semibold">
                            ðŸ’° {selectedTeam} has ${teamData[selectedTeam].capSpace.toFixed(1)}M in actual cap space
                          </p>
                          <p className="text-green-300 text-xs mt-1">
                            (After accounting for all cap holds and exceptions)
                          </p>
                        </div>
                      )}
                      
                      {/* Cap vs Apron vs Tax Salary Explanation */}
                      {selectedTeam && (
                        <div className="mt-3 p-3 bg-blue-900/30 border border-blue-700 rounded-lg">
                          <p className="text-blue-400 text-xs font-semibold mb-2">ðŸ“Š Three Different Salary Calculations</p>
                          <div className="space-y-1 text-xs">
                            <div className="flex justify-between">
                              <span className="text-gray-400">Cap Allocations:</span>
                              <span className="text-white">${teamData[selectedTeam].capSalary.toFixed(1)}M</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-gray-400">Tax Salary:</span>
                              <span className="text-white">${teamData[selectedTeam].taxSalary.toFixed(1)}M</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-gray-400">Apron Salary:</span>
                              <span className="text-white">${teamData[selectedTeam].apronSalary.toFixed(1)}M</span>
                            </div>
                            <div className="flex justify-between pt-1 border-t border-gray-600">
                              <span className="text-gray-400">Difference (Cap - Apron):</span>
                              <span className="text-yellow-400">${(teamData[selectedTeam].capSalary - teamData[selectedTeam].apronSalary).toFixed(1)}M</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-gray-400">Difference (Tax - Apron):</span>
                              <span className="text-yellow-400">${(teamData[selectedTeam].taxSalary - teamData[selectedTeam].apronSalary).toFixed(1)}M</span>
                            </div>
                          </div>
                          <p className="text-gray-400 text-xs mt-2">
                            * Cap allocations include holds â€¢ Tax salary used for luxury tax â€¢ Apron salary determines restrictions
                          </p>
                        </div>
                      )}
                      
                      {/* Hard Cap Compliance Warning */}
                      {selectedTeam && teamData[selectedTeam]?.hardCap && 
                       teamData[selectedTeam].apronSalary > (teamData[selectedTeam].hardCap === "first" ? 195.945 : 207.824) && (
                        <div className="mt-3 p-3 bg-red-900/50 border-2 border-red-600 rounded-lg animate-pulse">
                          <p className="text-red-400 text-sm font-bold">
                            ðŸš¨ CRITICAL COMPLIANCE ISSUE ðŸš¨
                          </p>
                          <p className="text-red-300 text-xs mt-1">
                            {selectedTeam} is ${(teamData[selectedTeam].apronSalary - (teamData[selectedTeam].hardCap === "first" ? 195.945 : 207.824)).toFixed(1)}M OVER their hard cap!
                          </p>
                          <p className="text-red-300 text-xs">
                            Must immediately shed salary to get under ${teamData[selectedTeam].hardCap === "first" ? "195.945M" : "207.824M"}
                          </p>
                        </div>
                      )}
                      
                      {/* Hard Cap Warning */}
                      {selectedTeam && teamData[selectedTeam]?.hardCap && (
                        <div className="mt-3 p-3 bg-red-900/30 border border-red-700 rounded-lg">
                          <p className="text-red-400 text-xs font-semibold">
                            âš ï¸ {selectedTeam} is hard-capped at the {teamData[selectedTeam].hardCap} apron
                          </p>
                          <p className="text-red-300 text-xs mt-1">
                            Reason: {teamData[selectedTeam].reason}
                          </p>
                          {teamData[selectedTeam].apronSalary > (teamData[selectedTeam].hardCap === "first" ? 195.945 : 207.824) && (
                            <p className="text-red-400 text-xs mt-1 font-bold">
                              âš ï¸ CRITICAL: Team is ${(teamData[selectedTeam].apronSalary - (teamData[selectedTeam].hardCap === "first" ? 195.945 : 207.824)).toFixed(1)}M OVER their hard cap! Must shed salary immediately!
                            </p>
                          )}
                        </div>
                      )}
                      
                      {/* Team Status Summary */}
                      {selectedTeam && (
                        <div className="mt-4 p-4 bg-gray-700 rounded-lg">
                          <h4 className="text-sm font-semibold mb-2 text-blue-400">ðŸ“‹ {selectedTeam} Status Summary</h4>
                          <div className="space-y-2 text-xs">
                            <div className="flex justify-between">
                              <span className="text-gray-400">Cap Allocations:</span>
                              <span className="text-white">${teamData[selectedTeam].capSalary.toFixed(1)}M</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-gray-400">Tax Salary:</span>
                              <span className="text-white">${teamData[selectedTeam].taxSalary.toFixed(1)}M</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-gray-400">Apron Salary:</span>
                              <span className="text-white">${teamData[selectedTeam].apronSalary.toFixed(1)}M</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-gray-400">Apron Status:</span>
                              <span className={
                                teamData[selectedTeam].apronSalary < 154.647 ? "text-green-400" :
                                teamData[selectedTeam].apronSalary < 187.895 ? "text-blue-400" :
                                teamData[selectedTeam].apronSalary < 195.945 ? "text-yellow-400" :
                                teamData[selectedTeam].apronSalary < 207.824 ? "text-orange-400" :
                                "text-red-400"
                              }>
                                {getTeamCapStatus(teamData[selectedTeam].apronSalary.toString())}
                              </span>
                            </div>
                            {teamData[selectedTeam].capSpace && (
                              <div className="flex justify-between">
                                <span className="text-gray-400">Actual Cap Space:</span>
                                <span className="text-green-400">${teamData[selectedTeam].capSpace.toFixed(1)}M</span>
                              </div>
                            )}
                            {teamData[selectedTeam].taxBill > 0 && (
                              <div className="flex justify-between">
                                <span className="text-gray-400">Luxury Tax Bill:</span>
                                <span className="text-yellow-400">${teamData[selectedTeam].taxBill.toFixed(1)}M ðŸ’¸</span>
                              </div>
                            )}
                            {teamData[selectedTeam].hardCap && (
                              <>
                                <div className="flex justify-between">
                                  <span className="text-gray-400">Hard Cap:</span>
                                  <span className="text-red-400">
                                    {teamData[selectedTeam].hardCap === "first" ? "$195.945M (1st Apron)" : "$207.824M (2nd Apron)"}
                                  </span>
                                </div>
                                <div className="flex justify-between">
                                  <span className="text-gray-400">Room Under Hard Cap:</span>
                                  <span className={
                                    teamData[selectedTeam].apronSalary > (teamData[selectedTeam].hardCap === "first" ? 195.945 : 207.824) ?
                                    "text-red-400" : "text-yellow-400"
                                  }>
                                    ${(
                                      (teamData[selectedTeam].hardCap === "first" ? 195.945 : 207.824) - 
                                      teamData[selectedTeam].apronSalary
                                    ).toFixed(1)}M
                                    {teamData[selectedTeam].apronSalary > (teamData[selectedTeam].hardCap === "first" ? 195.945 : 207.824) && 
                                      " (OVER - Must shed salary!)"}
                                  </span>
                                </div>
                              </>
                            )}
                            
                            {/* Available Exceptions Status */}
                            <div className="mt-2 pt-2 border-t border-gray-600">
                              <span className="text-gray-400">Key Exceptions:</span>
                              <div className="mt-1 space-y-1">
                                {/* Room MLE Status */}
                                {teamData[selectedTeam].exceptionsUsed.includes("RoomMLE") && (
                                  <div className="text-xs text-red-300">â€¢ Room MLE: Used âŒ</div>
                                )}
                                
                                {/* NT-MLE Status - Not available if Room MLE was used or team is over first apron */}
                                {teamData[selectedTeam].exceptionsUsed.includes("RoomMLE") ? (
                                  <div className="text-xs text-gray-500">â€¢ NT-MLE: Not Available (used cap space)</div>
                                ) : teamData[selectedTeam].apronSalary >= 195.945 ? (
                                  <div className="text-xs text-gray-500">â€¢ NT-MLE: Not Available (over 1st apron)</div>
                                ) : teamData[selectedTeam].exceptionsUsed.includes("NTMLE") || 
                                   teamData[selectedTeam].exceptionsUsed.includes("MLE") ? (
                                  <div className="text-xs text-red-300">â€¢ NT-MLE: Used âŒ</div>
                                ) : (
                                  <div className="text-xs text-green-300">â€¢ NT-MLE: Available âœ“</div>
                                )}
                                
                                {/* BAE Status - Not available if Room MLE was used or team is over first apron */}
                                {teamData[selectedTeam].exceptionsUsed.includes("RoomMLE") ? (
                                  <div className="text-xs text-gray-500">â€¢ BAE: Not Available (used cap space)</div>
                                ) : teamData[selectedTeam].apronSalary >= 195.945 ? (
                                  <div className="text-xs text-gray-500">â€¢ BAE: Not Available (over 1st apron)</div>
                                ) : teamData[selectedTeam].exceptionsUsed.includes("BAE") ? (
                                  <div className="text-xs text-red-300">â€¢ BAE: Used âŒ</div>
                                ) : (
                                  <div className="text-xs text-green-300">â€¢ BAE: Available âœ“</div>
                                )}
                                
                                {/* TP-MLE Status - Only available for teams below second apron */}
                                {teamData[selectedTeam].apronSalary >= 207.824 ? (
                                  <div className="text-xs text-gray-500">â€¢ TP-MLE: Not Available (over 2nd apron)</div>
                                ) : teamData[selectedTeam].apronSalary >= 187.895 && (
                                  teamData[selectedTeam].exceptionsUsed.includes("RoomMLE") ? (
                                    <div className="text-xs text-gray-500">â€¢ TP-MLE: Not Available (used cap space)</div>
                                  ) : teamData[selectedTeam].exceptionsUsed.includes("TPMLE") ? (
                                    <div className="text-xs text-red-300">â€¢ TP-MLE: Used âŒ</div>
                                  ) : teamData[selectedTeam].exceptionsUsed.includes("NTMLE") ? (
                                    <div className="text-xs text-gray-500">â€¢ TP-MLE: Not Available (used NT-MLE)</div>
                                  ) : (
                                    <div className="text-xs text-green-300">â€¢ TP-MLE: Available âœ“</div>
                                  )
                                )}
                              </div>
                              
                              {/* Other exceptions */}
                              {teamData[selectedTeam].exceptionsUsed.includes("aggregation") && (
                                <div className="text-xs text-red-300">â€¢ Salary Aggregation: Used (2nd apron HC) âŒ</div>
                              )}
                              {teamData[selectedTeam].exceptionsUsed.includes("SNT") && (
                                <div className="text-xs text-red-300">â€¢ Sign-and-Trade: Used âŒ</div>
                              )}
                            </div>
                          </div>
                        </div>
                      )}
                    </div>
                    
                    <div>
                      <label className="block text-sm font-medium mb-2">Team Cap Status</label>
                      <select
                        value={selectedCap}
                        onChange={handleCapChange}
                        className="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:border-blue-500 text-white"
                      >
                        <option value="">Select your team's cap situation...</option>
                        {capOptions.map(opt => (
                          <option key={opt.id} value={opt.id}>{opt.label} - {opt.description}</option>
                        ))}
                      </select>
                      {selectedTeam && (
                        <p className="mt-2 text-xs text-gray-500">
                          Cap status auto-selected based on {selectedTeam}'s salary. You can manually override if needed.
                        </p>
                      )}
                    </div>
                  </div>

                  {selectedCap && (
                    <>
                      <div className={`mt-4 p-4 bg-gray-700 rounded-lg ${getCapStatusColor(selectedCap)}`}>
                        <h3 className="font-semibold mb-1">
                          {capOptions.find(opt => opt.id === selectedCap)?.label}
                        </h3>
                        <p className="text-sm text-gray-300">
                          {capOptions.find(opt => opt.id === selectedCap)?.description}
                        </p>
                      </div>

                      {/* Trade Rules Summary */}
                      <div className="mt-4 p-4 bg-gray-700 rounded-lg border border-gray-600">
                        <h4 className="font-semibold mb-2 text-blue-400">ðŸ“Š Trade Matching Rules & Available Exceptions</h4>
                        <div className="text-sm text-gray-300">
                          {selectedCap === "RoomTeam" && (
                            <div>
                              <p className="font-semibold text-green-400 mb-2">Trade Rules:</p>
                              <ul className="space-y-1 mb-3">
                                <li>â€¢ Can absorb contracts using cap space + $250,000</li>
                                <li>â€¢ No salary matching required when using cap room</li>
                                <li>â€¢ Can also use standard trade exceptions instead</li>
                                <li>â€¢ Most flexible trade options available</li>
                              </ul>
                              <p className="font-semibold text-green-400 mb-2">Available Exceptions:</p>
                              <ul className="space-y-1">
                                <li>â€¢ Room MLE: $8.781M (no hard cap)</li>
                                <li>â€¢ Veteran minimums</li>
                              </ul>
                            </div>
                          )}
                          {(selectedCap === "NonTaxTeam" || selectedCap === "TaxTeam") && (
                            <div>
                              <p className="font-semibold text-blue-400 mb-2">Trade Rules:</p>
                              <ul className="space-y-1 mb-3">
                                <li>â€¢ <span className="text-yellow-300">Standard:</span> 100% + $250k (no hard cap)</li>
                                <li>â€¢ <span className="text-orange-300">Aggregated:</span> 100% of 2+ players + $250k (HC at 2nd apron)</li>
                                <li>â€¢ <span className="text-red-300">Expanded:</span> Greater of: [200% OR 100%+$8.5M] OR [125%+$250k] (HC at 1st apron)</li>
                                <li className="text-xs text-gray-400 mt-1">Note: $250k cushion becomes $0 if trade would exceed 1st apron</li>
                              </ul>
                              <p className="font-semibold text-blue-400 mb-2">Available Exceptions:</p>
                              <ul className="space-y-1">
                                <li>â€¢ NT-MLE: $14.104M (HC at 1st if 3+ years or > $5.685M)</li>
                                <li>â€¢ BAE: $5.134M (HC at 1st apron)</li>
                                <li>â€¢ Veteran minimums</li>
                              </ul>
                            </div>
                          )}
                          {selectedCap === "FirstApronTeam" && (
                            <div>
                              <p className="font-semibold text-orange-400 mb-2">Trade Rules:</p>
                              <ul className="space-y-1 mb-3">
                                <li>â€¢ Limited to 100% matching only (no $250k cushion)</li>
                                <li>â€¢ <span className="text-yellow-300">CAN aggregate salaries</span> but must match exactly</li>
                                <li>â€¢ <span className="text-red-400">Cannot use expanded trade rules</span></li>
                                <li>â€¢ Cannot take back more salary than sent out</li>
                                <li>â€¢ Can still create/use TPEs from trades</li>
                              </ul>
                              <p className="font-semibold text-orange-400 mb-2">Available Exceptions:</p>
                              <ul className="space-y-1">
                                <li>â€¢ TP-MLE: $5.685M (HC at 2nd apron)</li>
                                <li>â€¢ Veteran minimums</li>
                                <li className="text-red-300">â€¢ NT-MLE and BAE are NOT available</li>
                              </ul>
                            </div>
                          )}
                          {selectedCap === "SecondApronTeam" && (
                            <div>
                              <p className="font-semibold text-red-400 mb-2">Trade Rules:</p>
                              <ul className="space-y-1 mb-3">
                                <li className="text-red-400">â€¢ Cannot aggregate salaries</li>
                                <li className="text-red-400">â€¢ Cannot take back more salary than sent out</li>
                                <li className="text-red-400">â€¢ Cannot use cash in trades</li>
                                <li className="text-red-400">â€¢ Cannot use pre-existing TPEs</li>
                                <li className="text-red-400">â€¢ Frozen draft pick 7 years out</li>
                              </ul>
                              <p className="font-semibold text-red-400 mb-2">Available Exceptions:</p>
                              <ul className="space-y-1">
                                <li>â€¢ Veteran minimums ONLY</li>
                                <li className="text-red-300">â€¢ NO MLE of any kind available</li>
                              </ul>
                            </div>
                          )}
                        </div>
                      </div>
                    </>
                  )}
                </div>

                {/* Available Tools Selection */}
                {selectedCap && (
                  <div className="bg-gray-800 rounded-lg p-6 mb-6">
                    <label className="block text-sm font-medium mb-2">Available Roster Tools</label>
                    <select
                      value={selectedTool}
                      onChange={handleToolChange}
                      className="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:border-blue-500 text-white"
                    >
                      <option value="">Select a tool to use...</option>
                      {availableTools.map(tool => {
                        // Check if tool would trigger hard cap issues
                        const isProblematic = selectedTeam && teamData[selectedTeam]?.hardCap && (
                          (tool.id === "TradeAggregated" && teamData[selectedTeam].hardCap === "first") ||
                          (tool.id === "NTMLE" && teamData[selectedTeam].hardCap) ||
                          (tool.id === "BAE" && teamData[selectedTeam].hardCap)
                        );
                        
                        return (
                          <option key={tool.id} value={tool.id}>
                            {tool.label}
                            {isProblematic && " âš ï¸ (May conflict with hard cap)"}
                          </option>
                        );
                      })}
                    </select>

                    {/* Tool Description */}
                    {selectedTool && (
                      <div className="mt-4 p-4 bg-gray-700 rounded-lg">
                        <h3 className="font-semibold mb-1">
                          {availableTools.find(t => t.id === selectedTool)?.label}
                        </h3>
                        <p className="text-sm text-gray-300">
                          {availableTools.find(t => t.id === selectedTool)?.description}
                        </p>
                      </div>
                    )}
                  </div>
                )}

                {/* Implications Display */}
                {selectedTool && implications && (
                  <div className="space-y-4">
                    {/* Trade-Specific Alert for Trade Tools */}
                    {(selectedTool.includes("Trade") || selectedTool === "TradeRoomPlus") && (
                      <div className="bg-blue-900/30 border border-blue-700 rounded-lg p-4">
                        <h3 className="text-blue-400 font-semibold mb-2 flex items-center">
                          <span className="mr-2">ðŸ”„</span>
                          Trade Tool Selected
                        </h3>
                        <p className="text-blue-300 text-sm">
                          {selectedTool === "TradeRoomPlus" && "You can absorb contracts into your cap space without matching salaries."}
                          {selectedTool === "TradeStandard" && "You must send out roughly equal salary to what you take back."}
                          {selectedTool === "TradeAggregated" && "You can combine multiple outgoing contracts but will trigger the second apron hard cap."}
                          {selectedTool === "TradeExpanded" && "You can take back significantly more salary but will trigger the first apron hard cap."}
                          {selectedTool === "TradeStandardOnly" && "Your trade flexibility is limited - no salary aggregation allowed."}
                          {selectedTool === "TradeLimitedSevere" && "You face the most restrictive trade rules in the CBA."}
                        </p>
                      </div>
                    )}

                    {/* Restrictions Alert */}
                    {implications.restrictions.length > 0 && (
                      <div className="bg-red-900/30 border border-red-700 rounded-lg p-4">
                        <h3 className="text-red-400 font-semibold mb-2 flex items-center">
                          <span className="mr-2">âš ï¸</span>
                          Key Restrictions
                        </h3>
                        <ul className="space-y-1">
                          {implications.restrictions.map((restriction, index) => (
                            <li key={index} className="text-red-300 text-sm">â€¢ {restriction}</li>
                          ))}
                        </ul>
                      </div>
                    )}
                    
                    {/* Room to Aprons - Shows for all teams */}
                    {(teamSalary || selectedTeam) && (
                      <div className="mt-3 p-3 bg-gray-700 rounded-lg">
                        <h4 className="text-sm font-semibold mb-2">Room to Thresholds:</h4>
                        <div className="space-y-2 text-xs">
                          {((selectedTeam ? teamData[selectedTeam].apronSalary : parseFloat(teamSalary)) < 195.945) && (
                            <div className="flex justify-between">
                              <span className="text-gray-400">To 1st Apron:</span>
                              <span className="text-yellow-400">
                                ${(195.945 - (selectedTeam ? teamData[selectedTeam].apronSalary : parseFloat(teamSalary))).toFixed(1)}M
                              </span>
                            </div>
                          )}
                          {((selectedTeam ? teamData[selectedTeam].apronSalary : parseFloat(teamSalary)) < 207.824) && (
                            <div className="flex justify-between">
                              <span className="text-gray-400">To 2nd Apron:</span>
                              <span className="text-red-400">
                                ${(207.824 - (selectedTeam ? teamData[selectedTeam].apronSalary : parseFloat(teamSalary))).toFixed(1)}M
                              </span>
                            </div>
                          )}
                          {((selectedTeam ? teamData[selectedTeam].apronSalary : parseFloat(teamSalary)) >= 195.945) && (
                            <div className="text-center text-gray-500 py-2">
                              {(selectedTeam ? teamData[selectedTeam].apronSalary : parseFloat(teamSalary)) >= 207.824 ? 
                                "Already over 2nd apron - most restrictive rules apply" :
                                "Already over 1st apron - limited flexibility"}
                            </div>
                          )}
                        </div>
                      </div>
                    )}

                    {/* Pros */}
                    <div className="bg-green-900/20 border border-green-700 rounded-lg p-4">
                      <h3 className="text-green-400 font-semibold mb-2 flex items-center">
                        <span className="mr-2">âœ…</span>
                        Advantages
                      </h3>
                      <ul className="space-y-1">
                        {implications.pros.map((pro, index) => (
                          <li key={index} className="text-green-300 text-sm">â€¢ {pro}</li>
                        ))}
                      </ul>
                    </div>

                    {/* Cons */}
                    <div className="bg-yellow-900/20 border border-yellow-700 rounded-lg p-4">
                      <h3 className="text-yellow-400 font-semibold mb-2 flex items-center">
                        <span className="mr-2">âš¡</span>
                        Limitations
                      </h3>
                      <ul className="space-y-1">
                        {implications.cons.map((con, index) => (
                          <li key={index} className="text-yellow-300 text-sm">â€¢ {con}</li>
                        ))}
                      </ul>
                    </div>
                  </div>
                )}

                {/* Summary Card */}
                {selectedCap && selectedTool && (
                  <div className="mt-6 bg-gray-800 rounded-lg p-6">
                    <h3 className="text-lg font-semibold mb-3">Decision Summary</h3>
                    <div className="space-y-2 text-sm">
                      {selectedTeam && (
                        <>
                          <div className="flex justify-between">
                            <span className="text-gray-400">Team:</span>
                            <span className="text-white font-semibold">{selectedTeam}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-gray-400">Cap Allocations:</span>
                            <span className="text-white">${teamData[selectedTeam].capSalary.toFixed(1)}M</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-gray-400">Tax Salary:</span>
                            <span className="text-white">${teamData[selectedTeam].taxSalary.toFixed(1)}M</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-gray-400">Apron Salary:</span>
                            <span className="text-white">${teamData[selectedTeam].apronSalary.toFixed(1)}M</span>
                          </div>
                        </>
                      )}
                      {!selectedTeam && teamSalary && (
                        <div className="flex justify-between">
                          <span className="text-gray-400">Manual Salary:</span>
                          <span className="text-white">${teamSalary}M</span>
                        </div>
                      )}
                      <div className="flex justify-between">
                        <span className="text-gray-400">Cap Status:</span>
                        <span className={getCapStatusColor(selectedCap)}>
                          {capOptions.find(opt => opt.id === selectedCap)?.label}
                        </span>
                      </div>
                      {selectedTeam && teamData[selectedTeam]?.hardCap && (
                        <div className="flex justify-between">
                          <span className="text-gray-400">Current Hard Cap:</span>
                          <span className="text-red-400">
                            {teamData[selectedTeam].hardCap === "first" ? "1st Apron ($195.945M)" : "2nd Apron ($207.824M)"}
                          </span>
                        </div>
                      )}
                      <div className="flex justify-between">
                        <span className="text-gray-400">Selected Tool:</span>
                        <span className="text-white">
                          {availableTools.find(t => t.id === selectedTool)?.label}
                        </span>
                      </div>
                      {(selectedTool.includes("Trade") || selectedTool === "TradeRoomPlus") && (
                        <div className="flex justify-between">
                          <span className="text-gray-400">Trade Type:</span>
                          <span className="text-blue-400">
                            {selectedTool === "TradeRoomPlus" && "Absorbing into cap"}
                            {selectedTool === "TradeStandard" && "Standard matching"}
                            {selectedTool === "TradeAggregated" && "Aggregating contracts"}
                            {selectedTool === "TradeExpanded" && "Expanded matching"}
                            {selectedTool === "TradeStandardOnly" && "Limited matching"}
                            {selectedTool === "TradeLimitedSevere" && "Severely restricted"}
                          </span>
                        </div>
                      )}
                      {(implications?.restrictions.includes("Hard cap at $195.945M (first apron)") || 
                        implications?.restrictions.includes("Hard cap at $195.945M if: Contract is 3+ years OR total MLE usage exceeds $5.685M (taxpayer MLE limit)")) && (
                        <div className="flex justify-between text-red-400">
                          <span>Hard Cap:</span>
                          <span>$195.945M (First Apron){implications?.restrictions.includes("if:") ? "*" : ""}</span>
                        </div>
                      )}
                      {implications?.restrictions.includes("Triggers hard cap at $207.824M (second apron)") && (
                        <div className="flex justify-between text-red-400">
                          <span>Hard Cap:</span>
                          <span>$207.824M (Second Apron)</span>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {/* Team Cap Impact Table */}
                {selectedCap && selectedTool && (
                  <div className="mt-6 bg-gray-800 rounded-lg p-6">
                    <h3 className="text-lg font-semibold mb-4">Tool Usage Cap Impact Analysis</h3>
                    <p className="text-xs text-gray-400 mb-3">Shows if using the selected tool would trigger a hard cap</p>
                    <div className="overflow-x-auto">
                      <table className="w-full text-sm">
                        <thead>
                          <tr className="border-b border-gray-700 text-xs uppercase tracking-wider">
                            <th className="text-left py-3 px-2">Status</th>
                            <th className="text-center py-3 px-2">Current Year</th>
                            <th className="text-center py-3 px-2">1st Apron</th>
                            <th className="text-center py-3 px-2">2nd Apron</th>
                          </tr>
                        </thead>
                        <tbody className="text-gray-300">
                          <tr className="border-b border-gray-700/50">
                            <td className="py-3 px-2 font-medium">Your Team</td>
                            <td className="text-center py-3 px-2">
                              <div>
                                <span className={getCapStatusColor(selectedCap)}>
                                  {selectedCap === "RoomTeam" && "Under Cap"}
                                  {selectedCap === "NonTaxTeam" && "Under Tax"}
                                  {selectedCap === "TaxTeam" && "Over Tax"}
                                  {selectedCap === "FirstApronTeam" && "Over 1st Apron"}
                                  {selectedCap === "SecondApronTeam" && "Over 2nd Apron"}
                                </span>
                                {teamSalary && (
                                  <div className="text-xs text-gray-500 mt-1">
                                    {formatSalary(teamSalary)}
                                  </div>
                                )}
                              </div>
                            </td>
                            <td className="text-center py-3 px-2">
                              {(implications?.restrictions.includes("Hard cap at $195.945M (first apron)") || 
                                implications?.restrictions.includes("Hard cap at $195.945M if: Contract is 3+ years OR total MLE usage exceeds $5.685M (taxpayer MLE limit)")) ? (
                                <span className="text-red-400 font-semibold flex items-center justify-center">
                                  <span className="mr-1">ðŸ”’</span> 
                                  {implications?.restrictions.includes("if:") ? "LOCKED*" : "LOCKED"}
                                </span>
                              ) : (
                                <span className="text-gray-500">â€”</span>
                              )}
                            </td>
                            <td className="text-center py-3 px-2">
                              {implications?.restrictions.includes("Triggers hard cap at $207.824M (second apron)") ? (
                                <span className="text-red-400 font-semibold flex items-center justify-center">
                                  <span className="mr-1">ðŸ”’</span> LOCKED
                                </span>
                              ) : (
                                <span className="text-gray-500">â€”</span>
                              )}
                            </td>
                          </tr>
                          <tr className="text-xs">
                            <td className="py-2 px-2 text-gray-500">Threshold</td>
                            <td className="text-center py-2 px-2 text-gray-500">
                              {selectedCap === "RoomTeam" && "$154.647M"}
                              {selectedCap === "NonTaxTeam" && "$187.895M"}
                              {selectedCap === "TaxTeam" && "$195.945M"}
                              {selectedCap === "FirstApronTeam" && "$207.824M"}
                              {selectedCap === "SecondApronTeam" && "> $207.824M"}
                            </td>
                            <td className="text-center py-2 px-2 text-gray-500">$195.945M</td>
                            <td className="text-center py-2 px-2 text-gray-500">$207.824M</td>
                          </tr>
                        </tbody>
                      </table>
                      {selectedTool === "NTMLE" && (
                        <p className="text-xs text-gray-500 mt-2">
                          * LOCKED only if contract is 3+ years OR total MLE usage exceeds $5.685M
                        </p>
                      )}
                    </div>
                    
                    {/* Tool-specific warnings */}
                    {selectedTool && (
                      <div className="mt-4 p-3 bg-gray-700 rounded-lg">
                        <h4 className="text-sm font-semibold mb-2 text-yellow-400">âš ï¸ Using This Tool:</h4>
                        <ul className="text-xs space-y-1 text-gray-300">
                          {selectedTool === "NTMLE" && (
                            <>
                              <li>â€¢ Hard cap triggers ONLY if:</li>
                              <li className="ml-4">- Contract is 3+ years, OR</li>
                              <li className="ml-4">- Total MLE usage (can be split) exceeds $5.685M</li>
                              <li>â€¢ If you use less than $5.685M on 1-2 year deals: No hard cap</li>
                              <li>â€¢ Once triggered, cannot exceed $195.945M for any reason</li>
                              {selectedTeam && teamData[selectedTeam].hardCap && (
                                <li className="text-red-300">â€¢ {selectedTeam} is already hard-capped - check team status above</li>
                              )}
                            </>
                          )}
                          {selectedTool === "BAE" && (
                            <li>â€¢ Automatically hard caps your team at 1st apron ($195.945M)</li>
                          )}
                          {selectedTool === "SNT_Acquire" && (
                            <li>â€¢ Automatically hard caps your team at 1st apron ($195.945M)</li>
                          )}
                          {selectedTool === "TradeAggregated" && (
                            <li>â€¢ Automatically hard caps your team at 2nd apron ($207.824M)</li>
                          )}
                          {selectedTool === "TradeExpanded" && (
                            <li>â€¢ Automatically hard caps your team at 1st apron ($195.945M)</li>
                          )}
                          {selectedTool === "TPMLE" && (
                            <>
                              <li>â€¢ Automatically hard caps your team at 2nd apron ($207.824M)</li>
                              <li>â€¢ Cannot exceed 2nd apron for any reason once triggered</li>
                              <li>â€¢ Available to teams below 2nd apron</li>
                              <li>â€¢ Maximum $5.685M over 2 years</li>
                            </>
                          )}
                          {selectedTool === "TradeStandard" && (
                            <li>â€¢ No hard cap implications - full flexibility maintained</li>
                          )}
                          {selectedTool === "VetMin" && (
                            <li>â€¢ No hard cap implications - can sign multiple minimum contracts</li>
                          )}
                          {selectedTool === "RookieSign" && (
                            <li>â€¢ No hard cap implications for draft picks</li>
                          )}
                          {selectedTool === "CapSpace" && (
                            <li>â€¢ No hard cap - using available cap room</li>
                          )}
                          {selectedTool === "TradeRoomPlus" && (
                            <>
                              <li>â€¢ No hard cap - absorbing into cap space</li>
                              <li>â€¢ Can take contracts up to cap room + $250k</li>
                              <li>â€¢ $250k cushion reduced to $0 if trade puts you over 1st apron</li>
                              <li>â€¢ Cannot use other trade exceptions simultaneously</li>
                            </>
                          )}
                          {selectedTool === "TPEUse" && (
                            <>
                              <li>â€¢ No hard cap from using existing TPE</li>
                              <li>â€¢ Cannot use pre-existing TPEs if already over 1st apron</li>
                              <li>â€¢ Cannot use if over 2nd apron</li>
                              <li>â€¢ TPEs expire exactly one year after creation</li>
                              <li>â€¢ Cannot combine TPEs or add to player salaries</li>
                            </>
                          )}
                          {selectedTool === "TradeStandardOnly" && (
                            <>
                              <li>â€¢ No hard cap but severely limited flexibility</li>
                              <li>â€¢ Must match salaries exactly (100%, no $250k cushion)</li>
                              <li>â€¢ Cannot aggregate multiple contracts</li>
                              <li>â€¢ Very difficult to complete trades</li>
                            </>
                          )}
                          {selectedTool === "TradeLimitedSevere" && (
                            <>
                              <li>â€¢ Already over 2nd apron - most restrictive rules in place</li>
                              <li>â€¢ Cannot take back even $1 more in salary</li>
                              <li>â€¢ Cannot aggregate any salaries</li>
                              <li>â€¢ Cannot use cash to facilitate trades</li>
                              <li>â€¢ Cannot use any pre-existing TPEs</li>
                              <li>â€¢ Draft pick trading restrictions apply</li>
                            </>
                          )}
                          {selectedTool === "Use2Way" && (
                            <>
                              <li>â€¢ No hard cap implications</li>
                              <li>â€¢ Players must have 3 or fewer years of service</li>
                            </>
                          )}
                          {selectedTool === "UseDPE" && (
                            <>
                              <li>â€¢ No automatic hard cap</li>
                              <li>â€¢ Must apply between July 1 and January 15</li>
                              <li>â€¢ Requires NBA approval - player must be out through June 15</li>
                            </>
                          )}
                          {selectedTool === "StretchWaive" && (
                            <>
                              <li>â€¢ No hard cap implications</li>
                              <li>â€¢ Dead money counts against cap for (years remaining Ã— 2) + 1</li>
                            </>
                          )}
                        </ul>
                      </div>
                    )}
                  </div>
                )}

                {/* Actual Teams Cap Situation */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">NBA Team Cap Situations (2025-26)</h3>
                  <p className="text-xs text-gray-400 mb-3">Showing Cap Allocations, Tax Salary, Apron Salary, and Tax Bills for each team</p>
                  <div className="overflow-x-auto">
                    <table className="w-full text-xs">
                      <thead>
                        <tr className="border-b border-gray-700 text-gray-400 uppercase">
                          <th className="text-left py-2 px-1">Team</th>
                          <th className="text-center py-2 px-1">Cap Alloc</th>
                          <th className="text-center py-2 px-1">Tax Sal</th>
                          <th className="text-center py-2 px-1">Apron Sal</th>
                          <th className="text-center py-2 px-1">Tax Bill</th>
                          <th className="text-center py-2 px-1">Status</th>
                          <th className="text-center py-2 px-1">Hard Cap</th>
                        </tr>
                      </thead>
                      <tbody className="text-gray-300">
                        {/* Examples showing different scenarios */}
                        <tr className="border-b border-gray-700/30">
                          <td className="py-2 px-1 font-medium">CLE</td>
                          <td className="text-center py-2 px-1">$243.1M</td>
                          <td className="text-center py-2 px-1">$225.0M</td>
                          <td className="text-center py-2 px-1">$227.5M</td>
                          <td className="text-center py-2 px-1 text-yellow-400">$141.0M</td>
                          <td className="text-center py-2 px-1 text-red-400">Over 2nd</td>
                          <td className="text-center py-2 px-1">â€”</td>
                        </tr>
                        <tr className="border-b border-gray-700/30">
                          <td className="py-2 px-1 font-medium">BOS</td>
                          <td className="text-center py-2 px-1">$237.4M</td>
                          <td className="text-center py-2 px-1">$208.2M</td>
                          <td className="text-center py-2 px-1">$208.2M</td>
                          <td className="text-center py-2 px-1 text-yellow-400">$88.4M</td>
                          <td className="text-center py-2 px-1 text-red-400">Over 2nd</td>
                          <td className="text-center py-2 px-1">â€”</td>
                        </tr>
                        <tr className="border-b border-gray-700/30">
                          <td className="py-2 px-1 font-medium">DAL</td>
                          <td className="text-center py-2 px-1">$228.7M</td>
                          <td className="text-center py-2 px-1">$204.5M</td>
                          <td className="text-center py-2 px-1">$206.2M</td>
                          <td className="text-center py-2 px-1 text-yellow-400">$31.0M</td>
                          <td className="text-center py-2 px-1 text-orange-400">Over 1st</td>
                          <td className="text-center py-2 px-1 text-red-400">ðŸ”’ 2nd</td>
                        </tr>
                        <tr className="border-b border-gray-700/30">
                          <td className="py-2 px-1 font-medium">NYK</td>
                          <td className="text-center py-2 px-1">$233.6M</td>
                          <td className="text-center py-2 px-1">$204.1M</td>
                          <td className="text-center py-2 px-1">$204.1M</td>
                          <td className="text-center py-2 px-1 text-yellow-400">$29.7M</td>
                          <td className="text-center py-2 px-1 text-orange-400">Over 1st</td>
                          <td className="text-center py-2 px-1 text-red-400">ðŸ”’ 2nd</td>
                        </tr>
                        <tr className="border-b border-gray-700/30">
                          <td className="py-2 px-1 font-medium">LAL</td>
                          <td className="text-center py-2 px-1">$214.2M</td>
                          <td className="text-center py-2 px-1">$193.8M</td>
                          <td className="text-center py-2 px-1">$195.0M</td>
                          <td className="text-center py-2 px-1 text-yellow-400">$17.7M</td>
                          <td className="text-center py-2 px-1 text-yellow-400">Over Tax</td>
                          <td className="text-center py-2 px-1 text-red-400">ðŸ”’ 1st</td>
                        </tr>
                        <tr className="border-b border-gray-700/30">
                          <td className="py-2 px-1 font-medium">TOR</td>
                          <td className="text-center py-2 px-1">$221.4M</td>
                          <td className="text-center py-2 px-1">$192.9M</td>
                          <td className="text-center py-2 px-1">$199.3M</td>
                          <td className="text-center py-2 px-1 text-yellow-400">$5.0M</td>
                          <td className="text-center py-2 px-1 text-orange-400">Over 1st</td>
                          <td className="text-center py-2 px-1">â€”</td>
                        </tr>
                        <tr className="border-b border-gray-700/30">
                          <td className="py-2 px-1 font-medium">BKN</td>
                          <td className="text-center py-2 px-1">$134.7M</td>
                          <td className="text-center py-2 px-1">$114.4M</td>
                          <td className="text-center py-2 px-1">$115.2M</td>
                          <td className="text-center py-2 px-1">â€”</td>
                          <td className="text-center py-2 px-1 text-green-400">Under Cap</td>
                          <td className="text-center py-2 px-1">â€”</td>
                        </tr>
                        <tr className="border-b border-gray-700/30">
                          <td className="py-2 px-1 font-medium">PHX</td>
                          <td className="text-center py-2 px-1">$213.1M</td>
                          <td className="text-center py-2 px-1">$184.5M</td>
                          <td className="text-center py-2 px-1">$187.1M</td>
                          <td className="text-center py-2 px-1">â€”</td>
                          <td className="text-center py-2 px-1 text-blue-400">Non-Tax</td>
                          <td className="text-center py-2 px-1">â€”</td>
                        </tr>
                      </tbody>
                    </table>
                    <div className="mt-3 p-3 bg-gray-700 rounded text-xs">
                      <p className="text-gray-400 mb-1">
                        <span className="font-semibold text-yellow-400">* Apron Status:</span> Based on Apron Salary (excludes cap holds). 
                        Tax bills are actual amounts owed based on tax salary calculations.
                      </p>
                      <p className="text-gray-400 mb-1">
                        <span className="font-semibold">ðŸ”’ Hard Caps:</span> 1st Apron = $195.945M | 2nd Apron = $207.824M
                      </p>
                      <p className="text-gray-400">
                        <span className="font-semibold">ðŸ’¸ Tax Bills:</span> Teams paying luxury tax this season total over $400M in tax payments.
                      </p>
                    </div>
                  </div>
                </div>

                {/* Salary Cap Levels Reference */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">2025-26 Salary Cap Levels</h3>
                  <div className="grid grid-cols-2 gap-4 text-sm">
                    <div className="space-y-2">
                      <div className="flex justify-between">
                        <span className="text-gray-400">Salary Floor (90% of Cap):</span>
                        <span className="text-gray-400">$134.352M</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">Salary Cap:</span>
                        <span className="text-green-400">$154.647M</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">Luxury Tax:</span>
                        <span className="text-blue-400">$187.895M</span>
                      </div>
                    </div>
                    <div className="space-y-2">
                      <div className="flex justify-between">
                        <span className="text-gray-400">First Apron:</span>
                        <span className="text-yellow-400">$195.945M</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">Second Apron:</span>
                        <span className="text-red-400">$207.824M</span>
                      </div>
                    </div>
                  </div>
                  <div className="mt-4 grid grid-cols-2 gap-4">
                    <div className="p-3 bg-gray-700 rounded">
                      <h4 className="text-sm font-semibold mb-2 text-green-400">Exception Amounts:</h4>
                      <div className="text-xs text-gray-300 space-y-1">
                        <p>â€¢ Room Exception: $8.781M</p>
                        <p>â€¢ Non-Taxpayer MLE: $14.104M</p>
                        <p>â€¢ Taxpayer MLE: $5.685M</p>
                        <p>â€¢ Bi-Annual Exception: $5.134M</p>
                      </div>
                    </div>
                    <div className="p-3 bg-gray-700 rounded">
                      <h4 className="text-sm font-semibold mb-2 text-yellow-400">Key Restrictions:</h4>
                      <div className="text-xs text-gray-300 space-y-1">
                        <p>â€¢ 1st Apron: No NT-MLE/BAE access</p>
                        <p>â€¢ 1st Apron: No $250k trade cushion</p>
                        <p>â€¢ 2nd Apron: No aggregation</p>
                        <p>â€¢ 2nd Apron: No MLEs at all</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Trade Rules Quick Reference */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">Trade Matching Rules by Cap Status</h3>
                  <div className="overflow-x-auto">
                    <table className="w-full text-sm">
                      <thead>
                        <tr className="border-b border-gray-700">
                          <th className="text-left py-2 px-2">Cap Status</th>
                          <th className="text-left py-2 px-2">Standard Matching</th>
                          <th className="text-left py-2 px-2">Can Aggregate?</th>
                          <th className="text-left py-2 px-2">Expanded Trade?</th>
                          <th className="text-left py-2 px-2">Hard Cap Impact</th>
                        </tr>
                      </thead>
                      <tbody className="text-gray-300">
                        <tr className="border-b border-gray-700/50">
                          <td className="py-2 px-2 text-green-400">Room Team</td>
                          <td className="py-2 px-2">Cap Space + $250k</td>
                          <td className="py-2 px-2">N/A (absorbing)</td>
                          <td className="py-2 px-2">âœ… Yes (if choose to)</td>
                          <td className="py-2 px-2">Varies by method</td>
                        </tr>
                        <tr className="border-b border-gray-700/50">
                          <td className="py-2 px-2 text-blue-400">Non-Tax Team</td>
                          <td className="py-2 px-2">100% + $250k*</td>
                          <td className="py-2 px-2">âœ… Yes</td>
                          <td className="py-2 px-2">âœ… Yes</td>
                          <td className="py-2 px-2">Agg: 2nd / Exp: 1st</td>
                        </tr>
                        <tr className="border-b border-gray-700/50">
                          <td className="py-2 px-2 text-yellow-400">Tax Team</td>
                          <td className="py-2 px-2">100% + $250k*</td>
                          <td className="py-2 px-2">âœ… Yes</td>
                          <td className="py-2 px-2">âœ… Yes</td>
                          <td className="py-2 px-2">Agg: 2nd / Exp: 1st</td>
                        </tr>
                        <tr className="border-b border-gray-700/50">
                          <td className="py-2 px-2 text-orange-400">First Apron Team</td>
                          <td className="py-2 px-2">100% + $0</td>
                          <td className="py-2 px-2">âœ… Yes</td>
                          <td className="py-2 px-2">âŒ No</td>
                          <td className="py-2 px-2">Agg: 2nd apron</td>
                        </tr>
                        <tr>
                          <td className="py-2 px-2 text-red-400">Second Apron Team</td>
                          <td className="py-2 px-2">100% (no extra)</td>
                          <td className="py-2 px-2">âŒ No</td>
                          <td className="py-2 px-2">âŒ No</td>
                          <td className="py-2 px-2">None</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div className="mt-3 space-y-1 text-xs text-gray-500">
                    <p>* $250k cushion becomes $0 if trade would put team over First Apron</p>
                    <p>â€¢ <span className="font-semibold">Aggregation:</span> Cannot aggregate players acquired via exception in prior 2 months</p>
                    <p>â€¢ <span className="font-semibold">Expanded Formula:</span> Greater of: [Lesser of: 200% OR 100%+$8.5M] OR [125%+$250k] - Available to teams under first apron</p>
                  </div>
                </div>

                {/* Detailed Trade Exception Rules */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">Detailed Trade Exception Rules</h3>
                  
                  <div className="space-y-4">
                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-blue-400 mb-2">Important: $250k Cushion Rule</h4>
                      <ul className="text-sm text-gray-300 space-y-1">
                        <li>â€¢ All trade exceptions normally include a $250,000 cushion</li>
                        <li>â€¢ <span className="text-yellow-300">BUT:</span> If a trade would put your team over the First Apron ($195.945M)...</li>
                        <li className="ml-4 text-red-300">â†’ The $250k cushion is reduced to $0</li>
                        <li>â€¢ This applies to ALL trade types (standard, aggregated, expanded, room)</li>
                        <li>â€¢ Teams must match salaries exactly if the trade would push them over First Apron</li>
                      </ul>
                    </div>

                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-green-400 mb-2">Standard Trade Exception</h4>
                      <ul className="text-sm text-gray-300 space-y-1">
                        <li>â€¢ Replace 1 traded player with 1+ players</li>
                        <li>â€¢ Incoming salaries â‰¤ 100% of outgoing + $250,000</li>
                        <li>â€¢ Can acquire players non-simultaneously within 1 year</li>
                        <li>â€¢ Creates TPE for salary differential</li>
                        <li>â€¢ $250k reduced to $0 if trade puts team over First Apron</li>
                      </ul>
                    </div>

                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-yellow-400 mb-2">Aggregated Trade Exception</h4>
                      <ul className="text-sm text-gray-300 space-y-1">
                        <li>â€¢ Replace 2+ traded players with 1+ players</li>
                        <li>â€¢ Incoming salaries â‰¤ 100% of aggregated outgoing + $250,000</li>
                        <li>â€¢ Must be simultaneous trades</li>
                        <li>â€¢ <span className="text-red-300">Triggers hard cap at Second Apron</span></li>
                        <li>â€¢ Cannot aggregate players acquired via exception in prior 2 months</li>
                        <li>â€¢ Special rules for minimum salary players when 3+ outgoing</li>
                      </ul>
                    </div>

                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-orange-400 mb-2">Expanded Trade Exception</h4>
                      <ul className="text-sm text-gray-300 space-y-1">
                        <li>â€¢ Available to teams under the first apron (can be over tax)</li>
                        <li>â€¢ Can take back the GREATER of these two options:</li>
                        <li className="ml-4"><span className="text-blue-300">Option 1:</span> The LESSER of:</li>
                        <li className="ml-8">â€¢ 200% of outgoing salary + $250k</li>
                        <li className="ml-8">â€¢ 100% of outgoing + $8.5M</li>
                        <li className="ml-4"><span className="text-blue-300">Option 2:</span> 125% of outgoing + $250k</li>
                        <li>â€¢ <span className="text-red-300">Triggers hard cap at First Apron</span></li>
                        <li className="text-xs text-gray-400">* $8.5M is the 2025-26 adjusted amount (was $7.5M in 2023-24)</li>
                      </ul>
                    </div>

                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-red-400 mb-2">Key Restrictions</h4>
                      <ul className="text-sm text-gray-300 space-y-1">
                        <li>â€¢ <span className="font-semibold">2-Month Rule:</span> Cannot aggregate contracts of players acquired via exception in prior 2 months</li>
                        <li className="ml-4 text-xs">Exception: Players acquired before Dec 16 can be aggregated after trade deadline</li>
                        <li>â€¢ <span className="font-semibold">Minimum Salary Rule:</span> When aggregating 3+ players and receiving fewer back, only 1 can be minimum salary</li>
                        <li className="ml-4 text-xs">Exception: This rule doesn't apply from Dec 15 - trade deadline</li>
                        <li>â€¢ <span className="font-semibold">Non-Guaranteed Contracts:</span> Only guaranteed portion counts for trade matching</li>
                        <li className="ml-4 text-xs">After Jan 8: Current season salary deemed fully guaranteed</li>
                        <li>â€¢ <span className="font-semibold">First Apron Teams:</span> CAN aggregate salaries but NO $250k cushion (must match exactly)</li>
                        <li>â€¢ <span className="font-semibold">Second Apron Teams:</span> Cannot take back more salary, cannot aggregate, cannot use cash</li>
                      </ul>
                    </div>
                  </div>
                </div>

                {/* Trade Examples - MOVED TO BOTTOM */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">Trade Examples (2025-26)</h3>
                  <div className="space-y-3 text-sm">
                    <div className="p-3 bg-gray-700 rounded">
                      <p className="font-semibold text-green-400">Standard Trade (Non-Tax Team):</p>
                      <p className="text-gray-300">â€¢ Send out: $20M player</p>
                      <p className="text-gray-300">â€¢ Can receive: Up to $20.25M (100% + $250k)</p>
                      <p className="text-gray-300">â€¢ Creates TPE: If receive less (e.g., $15M = $5M TPE)</p>
                    </div>
                    
                    <div className="p-3 bg-gray-700 rounded">
                      <p className="font-semibold text-yellow-400">Aggregated Trade (Tax Team):</p>
                      <p className="text-gray-300">â€¢ Send out: $15M + $10M = $25M total</p>
                      <p className="text-gray-300">â€¢ Can receive: Up to $25.25M</p>
                      <p className="text-gray-300">â€¢ Result: <span className="text-red-300">Hard capped at 2nd apron</span></p>
                    </div>
                    
                    <div className="p-3 bg-gray-700 rounded">
                      <p className="font-semibold text-orange-400">Expanded Trade (Non-Tax Team):</p>
                      <p className="text-gray-300">â€¢ Send out: $10M player</p>
                      <p className="text-gray-300">â€¢ Option 1 (lesser of):</p>
                      <p className="text-gray-300 ml-4">- 200%: $20.25M</p>
                      <p className="text-gray-300 ml-4">- 100% + $8.5M: $18.5M â† lesser</p>
                      <p className="text-gray-300">â€¢ Option 2: 125% = $12.75M</p>
                      <p className="text-gray-300">â€¢ Can receive: $18.5M (greater of the two)</p>
                      <p className="text-gray-300">â€¢ Result: <span className="text-red-300">Hard capped at 1st apron</span></p>
                    </div>

                    <div className="p-3 bg-gray-700 rounded">
                      <p className="font-semibold text-orange-400">Expanded Trade Example 2:</p>
                      <p className="text-gray-300">â€¢ Send out: $40M player</p>
                      <p className="text-gray-300">â€¢ Option 1 (lesser of):</p>
                      <p className="text-gray-300 ml-4">- 200%: $80.25M</p>
                      <p className="text-gray-300 ml-4">- 100% + $8.5M: $48.5M â† lesser</p>
                      <p className="text-gray-300">â€¢ Option 2: 125% = $50.25M â† greater!</p>
                      <p className="text-gray-300">â€¢ Can receive: $50.25M</p>
                      <p className="text-gray-300 text-xs">â€¢ Note: 125% option better for larger salaries</p>
                    </div>
                    
                    <div className="p-3 bg-gray-700 rounded">
                      <p className="font-semibold text-red-400">First Apron Team Trade:</p>
                      <p className="text-gray-300">â€¢ Send out: $20M player</p>
                      <p className="text-gray-300">â€¢ Can receive: Up to $20M (NO $250k cushion)</p>
                      <p className="text-gray-300">â€¢ Very limited flexibility</p>
                    </div>
                    
                    <div className="p-3 bg-gray-700 rounded">
                      <p className="font-semibold text-purple-400">TPE Creation & Usage:</p>
                      <p className="text-gray-300">â€¢ Created when sending out more salary than receiving</p>
                      <p className="text-gray-300">â€¢ Example: Send $20M, receive $15M = $5M TPE</p>
                      <p className="text-gray-300">â€¢ Valid for 1 year from creation date</p>
                      <p className="text-gray-300">â€¢ <span className="text-red-300">Cannot use if over 1st/2nd apron</span></p>
                    </div>
                  </div>
                </div>

                {/* Exception Availability by Team Status */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">Exception Availability by Team Status</h3>
                  <p className="text-xs text-gray-400 mb-4">Which exceptions are available based on your team's salary position</p>
                  
                  <div className="overflow-x-auto">
                    <table className="w-full text-sm">
                      <thead>
                        <tr className="border-b border-gray-700">
                          <th className="text-left py-2 px-2">Team Status</th>
                          <th className="text-center py-2 px-2">Room MLE<br/><span className="text-xs text-gray-400">$8.781M</span></th>
                          <th className="text-center py-2 px-2">NT-MLE<br/><span className="text-xs text-gray-400">$14.104M</span></th>
                          <th className="text-center py-2 px-2">BAE<br/><span className="text-xs text-gray-400">$5.134M</span></th>
                          <th className="text-center py-2 px-2">TP-MLE<br/><span className="text-xs text-gray-400">$5.685M</span></th>
                          <th className="text-center py-2 px-2">Vet Min</th>
                        </tr>
                      </thead>
                      <tbody className="text-gray-300">
                        <tr className="border-b border-gray-700/50">
                          <td className="py-2 px-2 text-green-400">Under Cap</td>
                          <td className="text-center py-2 px-2">âœ…</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âœ…</td>
                        </tr>
                        <tr className="border-b border-gray-700/50">
                          <td className="py-2 px-2 text-blue-400">Over Cap, Under 1st Apron</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âœ…</td>
                          <td className="text-center py-2 px-2">âœ…</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âœ…</td>
                        </tr>
                        <tr className="border-b border-gray-700/50">
                          <td className="py-2 px-2 text-orange-400">Over 1st Apron, Under 2nd</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âœ…</td>
                          <td className="text-center py-2 px-2">âœ…</td>
                        </tr>
                        <tr>
                          <td className="py-2 px-2 text-red-400">Over 2nd Apron</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âŒ</td>
                          <td className="text-center py-2 px-2">âœ…</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  <div className="mt-4 space-y-2 text-xs text-gray-400">
                    <p><span className="text-green-400">Room MLE:</span> Only for teams with cap space. Does not trigger hard cap. Cannot be combined with NT-MLE or BAE.</p>
                    <p><span className="text-blue-400">NT-MLE & BAE:</span> Only for teams below first apron. NT-MLE triggers hard cap at 1st apron if 3+ years or > $5.685M. BAE always triggers hard cap at 1st apron.</p>
                    <p><span className="text-yellow-400">TP-MLE:</span> Only for teams below second apron. Always triggers hard cap at 2nd apron when used.</p>
                    <p><span className="text-white">Veteran Minimum:</span> Always available regardless of team status. No cap implications.</p>
                  </div>
                </div>

                {/* 2025-26 Exception Signings */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">2025-26 Exception Signings</h3>
                  <p className="text-xs text-gray-400 mb-4">Actual free agent signings using MLE and BAE exceptions</p>
                  
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-blue-400 mb-2">NT-MLE Signings (9 teams)</h4>
                      <ul className="text-xs text-gray-300 space-y-1">
                        <li>â€¢ <span className="text-white">ATL:</span> Luke Kennard</li>
                        <li>â€¢ <span className="text-white">DET:</span> Caris LeVert</li>
                        <li>â€¢ <span className="text-white">HOU:</span> Dorian Finney-Smith</li>
                        <li>â€¢ <span className="text-white">LAC:</span> Bradley Beal, Brook Lopez</li>
                        <li>â€¢ <span className="text-white">LAL:</span> Jake LaRavia, Deandre Ayton</li>
                        <li>â€¢ <span className="text-white">NOP:</span> Kevon Looney</li>
                        <li>â€¢ <span className="text-white">ORL:</span> Tyus Jones</li>
                        <li>â€¢ <span className="text-white">POR:</span> Damian Lillard</li>
                        <li>â€¢ <span className="text-white">SAS:</span> Luke Kornet</li>
                      </ul>
                    </div>
                    
                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-yellow-400 mb-2">TP-MLE Signings (2 teams)</h4>
                      <ul className="text-xs text-gray-300 space-y-1">
                        <li>â€¢ <span className="text-white">DAL:</span> D'Angelo Russell</li>
                        <li>â€¢ <span className="text-white">NYK:</span> Guerschon Yabusele</li>
                      </ul>
                      <p className="text-xs text-gray-500 mt-3">
                        Note: TP-MLE triggers hard cap at 2nd apron
                      </p>
                    </div>
                    
                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-green-400 mb-2">Room MLE Signings (2 teams)</h4>
                      <ul className="text-xs text-gray-300 space-y-1">
                        <li>â€¢ <span className="text-white">MEM:</span> Ty Jerome</li>
                        <li>â€¢ <span className="text-white">MIL:</span> Kevin Porter Jr.</li>
                      </ul>
                      <p className="text-xs text-gray-500 mt-3">
                        Note: Room MLE does not trigger a hard cap
                      </p>
                    </div>
                  </div>
                  
                  <div className="mt-4 p-3 bg-yellow-900/30 border border-yellow-700 rounded-lg">
                    <p className="text-yellow-400 text-xs font-semibold">ðŸ’¡ Key Points:</p>
                    <ul className="text-yellow-300 text-xs mt-1 space-y-1">
                      <li>â€¢ NT-MLE (Non-Taxpayer MLE) triggers hard cap at first apron if used for 3+ years or over $5.685M total</li>
                      <li>â€¢ TP-MLE (Taxpayer MLE) is limited to $5.685M and 2 years and triggers hard cap at 2nd apron</li>
                      <li>â€¢ Room MLE is for teams that used cap space and does NOT trigger a hard cap</li>
                      <li>â€¢ No teams have used the BAE (Bi-Annual Exception) yet this season</li>
                      <li className="text-red-300">â€¢ Teams over 1st apron CANNOT use NT-MLE or BAE</li>
                      <li className="text-red-300">â€¢ Teams over 2nd apron CANNOT use any MLE</li>
                    </ul>
                  </div>
                </div>

                {/* Hard Cap Information */}
                <div className="mt-8 bg-gray-800 rounded-lg p-6">
                  <h3 className="text-xl font-semibold mb-4">Hard Cap Triggers (2025-26)</h3>
                  
                  <div className="p-3 bg-yellow-900/30 border border-yellow-700 rounded-lg mb-4">
                    <p className="text-yellow-400 text-sm font-semibold">ðŸ“… Data Timing Note:</p>
                    <p className="text-yellow-300 text-xs mt-1">
                      The salary and hard cap trackers may be from different dates. Teams cannot legally exceed their hard cap. 
                      Any team showing as "over" must have made moves after triggering the cap but before the salary snapshot.
                    </p>
                  </div>
                  
                  <div className="space-y-4">
                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-yellow-400 mb-2">First Apron Hard Cap ($195.945M) Triggers:</h4>
                      <ul className="text-sm text-gray-300 space-y-1">
                        <li>â€¢ <span className="text-yellow-300">NT-MLE:</span> Using MLE exceeding taxpayer limits ($5.685M or 3+ years)</li>
                        <li>â€¢ <span className="text-yellow-300">BAE:</span> Using the Bi-Annual Exception</li>
                        <li>â€¢ <span className="text-yellow-300">Sign-and-Trade:</span> Acquiring a player via sign-and-trade</li>
                        <li>â€¢ <span className="text-yellow-300">Expanded Trade:</span> Using expanded trade matching rules</li>
                        <li>â€¢ <span className="text-yellow-300">Waived Player:</span> Signing player waived during season whose salary exceeded NT-MLE</li>
                        <li>â€¢ <span className="text-yellow-300">Prior TPE:</span> Using a traded player exception from previous season</li>
                      </ul>
                    </div>

                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-red-400 mb-2">Second Apron Hard Cap ($207.824M) Triggers:</h4>
                      <ul className="text-sm text-gray-300 space-y-1">
                        <li>â€¢ <span className="text-red-300">TP-MLE:</span> Using the Taxpayer Mid-Level Exception</li>
                        <li>â€¢ <span className="text-red-300">Trade Aggregation:</span> Combining 2+ players in a trade</li>
                        <li>â€¢ <span className="text-red-300">Cash Sent:</span> Sending cash in any trade</li>
                        <li>â€¢ <span className="text-red-300">S&T Outgoing:</span> Using sign-and-traded player's salary to acquire others</li>
                      </ul>
                    </div>

                    <div className="p-4 bg-gray-700 rounded-lg">
                      <h4 className="font-semibold text-blue-400 mb-2">Current Hard-Capped Teams (19 total):</h4>
                      <div className="grid grid-cols-2 gap-2 text-sm">
                        <div>
                          <p className="text-yellow-300 font-semibold mb-1">First Apron (14):</p>
                          <p className="text-gray-300 text-xs">ATL, CHA, CHI, DET, HOU, IND, LAC, LAL, MIA, NOP, ORL, POR, SAC, SAS, UTA, WAS</p>
                        </div>
                        <div>
                          <p className="text-red-300 font-semibold mb-1">Second Apron (3):</p>
                          <p className="text-gray-300 text-xs">DAL, DEN, NYK</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div className="mt-8 text-center text-sm text-gray-500">
                  <p>NBA Roster & Trade Decision Tool - Based on 2023 CBA Article VII Trade Rules</p>
                  <p className="mt-1">2025-26 Season â€¢ Uses Apron Salary for team status (excludes cap holds)</p>
                  <p className="mt-1">Cap allocations from NBA Team Salary Cap Tracker â€¢ Apron salaries from NBA Team Apron Tracker</p>
                </div>
              </div>
            </div>
          );
        };

        ReactDOM.render(<NBACapDecisionTool />, document.getElementById('root'));
    </script>
</body>
</html>
